<!DOCTYPE html>

<html lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>STè®¡åˆ’</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<style>.hourglass {
width: 100px;
height: 170px;
display: block;
margin: 0 auto;
}
.card {
border: none;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0,0,0,0.08);
margin-bottom: 0.75rem !important;
}
.card-header {
background: #f8f9fa;
border-bottom: 1px solid rgba(0,0,0,0.05);
padding: 0.75rem 1rem;
}
.goal-container {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
gap: 0.5rem !important;
padding: 0.5rem !important;
}
@media (max-width: 768px) {
.container {
padding: 15px;
}
.card-header {
flex-direction: column;
align-items: stretch !important;
gap: 0.5rem;
}
.card-header > div {
justify-content: center;
}
.btn-group {
margin-top: 0.5rem;
}
}
.btn-group .btn {
padding: 0.25rem 0.5rem;
font-size: 0.875rem;
}
.card-header {
padding: 0.75rem 1rem;
flex-direction: column;
align-items: stretch !important;
gap: 0.75rem;
}
.card-header .btn {
padding: 0.375rem 0.75rem;
white-space: nowrap;
}
@media (max-width: 768px) {
.card-header {
flex-direction: column;
align-items: stretch !important;
gap: 0.5rem;
}
.card-header > div {
justify-content: center;
}
.btn-group {
margin-top: 0.5rem;
}
}
.form-label {
margin-bottom: 0.5rem;
font-weight: 500;
}
.mb-3 {
margin-bottom: 1.25rem !important;
}
.card-header .btn-group {
flex-wrap: nowrap;
margin: 0 0.5rem;
}
.card-header .btn {
padding: 0.375rem 0.75rem;
}
/* è°ƒæ•´å¡ç‰‡å¤´éƒ¨æŒ‰é’®å¸ƒå±€ */
.card-header {
display: flex;
flex-wrap: wrap;
gap: 0.75rem;
padding: 1rem;
align-items: center;
}
.card-header .btn-group,
.card-header .action-buttons {
display: flex;
gap: 0.5rem;
flex-wrap: wrap;
}
/* ç¾åŒ–å¹´é¾„è¿›åº¦å¡ç‰‡æ ·å¼ */
.age-progress-card {
background: linear-gradient(to bottom right, #f8f9fa, #ffffff);
border-radius: 0.5rem;
padding: 1.5rem;
}
.age-progress-card .card-title {
color: #2c3e50;
font-size: 1.25rem;
margin-bottom: 1rem;
}
.age-progress-card .card-text {
color: #34495e;
line-height: 1.6;
margin-bottom: 1.25rem;
}
.age-progress-card .progress {
height: 1.5rem;
border-radius: 0.75rem;
background-color: #e9ecef;
margin: 1rem 0;
}
.age-progress-card .progress-bar {
background: linear-gradient(to right, #3498db, #2980b9);
border-radius: 0.75rem;
transition: width 0.3s ease;
}
.age-progress-card .progress-bar.bg-danger {
background: linear-gradient(to right, #e74c3c, #c0392b);
}
.age-progress-card .btn {
background: #3498db;
border: none;
padding: 0.5rem 1rem;
transition: all 0.3s ease;
}
.age-progress-card .btn:hover {
background: #2980b9;
transform: translateY(-1px);
}
/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
.card-header {
flex-direction: column;
align-items: stretch;
}
.card-header > div {
width: 100%;
}
.card-header .btn,
.card-header .btn-group {
width: 100%;
margin: 0.25rem 0;
}
}
/* å»æ‰æ•°å­—è¾“å…¥æ¡†çš„ä¸Šä¸‹ç®­å¤´ */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
-webkit-appearance: none;
margin: 0;
}
input[type="number"] {
-moz-appearance: textfield; /* Firefox */
}
.progress {
height: 8px !important;
background-color: #e9ecef;
border-radius: 0.25rem;
overflow: hidden;
margin: 0.25rem 0 !important;
}
.progress-bar {
display: flex;
flex-direction: column;
justify-content: center;
color: #fff;
text-align: center;
white-space: nowrap;
background-color: #0d6efd;
transition: width .6s ease;
}
.progress-bar.bg-danger {
background-color: #dc3545 !important;
}
/* è°ƒæ•´æ–‡å­—å’ŒæŒ‰é’®çš„é—´è· */
.card-title {
margin-bottom: 0.25rem !important;
}
.d-flex {
gap: 0.25rem !important;
}
/* è°ƒæ•´åˆ é™¤æŒ‰é’®çš„å¤§å°å’Œé—´è· */
.btn-danger.btn-sm {
padding: 0.1rem 0.3rem !important;
font-size: 0.7rem !important;
}
/* è°ƒæ•´æ–‡å­—å¤§å° */
.small {
font-size: 0.8rem !important;
}
/* è°ƒæ•´å‰©ä½™å¤©æ•°æ–‡å­—çš„æ ·å¼ */
.text-muted {
font-size: 0.75rem !important;
}
/* è°ƒæ•´å¡ç‰‡é—´è·å’Œå†…éƒ¨å¸ƒå±€ */
.card {
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.card-body {
padding: 0.5rem !important;
}
/* è°ƒæ•´æ ‡é¢˜å’Œå†…å®¹çš„é—´è· */
.card-title {
margin: 0 !important;
}
/* è°ƒæ•´è¿›åº¦æ¡å®¹å™¨çš„é—´è· */
.progress {
height: 8px !important;
margin: 0.25rem 0 !important;
}
/* è°ƒæ•´å‰©ä½™å¤©æ•°å’Œåˆ é™¤æŒ‰é’®çš„å¸ƒå±€ */
.d-flex.justify-content-between {
margin-top: 0.25rem !important;
}
/* è°ƒæ•´å¹´é¾„æ˜¾ç¤ºçš„é—´è· */
.text-muted {
margin: 0 !important;
padding: 0 !important;
}
/* è°ƒæ•´åˆ é™¤æŒ‰é’®çš„ä½ç½®å’Œå¤§å° */
.btn-danger.btn-sm {
padding: 0.1rem 0.3rem !important;
margin: 0 !important;
line-height: 1 !important;
}
/* è°ƒæ•´å‰©ä½™å¤©æ•°çš„æ˜¾ç¤º */
.card-body > div:last-child {
margin-top: 0.25rem !important;
}
/* è°ƒæ•´ç›®æ ‡å®¹å™¨çš„é—´è· */
.goal-container {
gap: 0.5rem !important;
padding: 0.5rem !important;
}
/* è°ƒæ•´å¡ç‰‡æ ‡é¢˜å’Œå†…å®¹çš„å­—ä½“å¤§å° */
.card-title {
margin: 0 !important;
font-size: 1rem !important; /* å¢å¤§æ ‡é¢˜å­—ä½“ */
}
/* è°ƒæ•´æ™®é€šæ–‡æœ¬å¤§å° */
.small {
font-size: 0.9rem !important; /* å¢å¤§æ™®é€šæ–‡æœ¬ */
}
/* è°ƒæ•´å‰©ä½™å¤©æ•°ç­‰è¾…åŠ©æ–‡æœ¬çš„å¤§å° */
.text-muted {
font-size: 0.85rem !important; /* å¢å¤§è¾…åŠ©æ–‡æœ¬ */
}
/* è°ƒæ•´åˆ é™¤æŒ‰é’®çš„å­—ä½“å¤§å° */
.btn-danger.btn-sm {
padding: 0.1rem 0.3rem !important;
font-size: 0.85rem !important; /* å¢å¤§æŒ‰é’®æ–‡å­— */
line-height: 1 !important;
}
/* è°ƒæ•´è¿›åº¦æ¡æ–‡å­—å¤§å° */
.progress-bar {
font-size: 0.85rem !important; /* å¢å¤§è¿›åº¦æ¡æ–‡å­— */
}
/* æ•´ä½“é¡µé¢å¸ƒå±€ä¼˜åŒ– */
.container {
max-width: 1200px;
padding: 1.5rem;
}
/* å¡ç‰‡æ ·å¼ä¼˜åŒ– */
.card {
border: none;
box-shadow: 0 2px 8px rgba(0,0,0,0.08);
transition: all 0.3s ease;
}
.card:hover {
box-shadow: 0 4px 12px rgba(0,0,0,0.12);
}
/* æ ‡é¢˜æ–‡å­—ä¼˜åŒ– */
.card-title {
color: #2c3e50;
font-weight: 600;
font-size: 1.1rem !important;
}
/* è¡¨å•æ ·å¼ä¼˜åŒ– */
.form-control {
border-radius: 6px;
border: 1px solid #e0e0e0;
padding: 0.5rem 0.75rem;
transition: all 0.3s ease;
}
.form-control:focus {
border-color: #3498db;
box-shadow: 0 0 0 0.2rem rgba(52,152,219,0.1);
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.btn {
font-size: 0.85rem !important;
padding: 0.35rem 0.5rem;
border-radius: 6px;
font-weight: 500;
transition: all 0.3s ease;
white-space: nowrap;
}
.btn:hover {
transform: translateY(-1px);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-sm {
padding: 0.25rem 0.5rem;
font-size: 0.8rem !important;
}
.btn-primary {
background: linear-gradient(45deg, #3498db, #2980b9);
border: none;
color: white;
}
.btn-success {
background: linear-gradient(45deg, #2ecc71, #27ae60);
border: none;
color: white;
}
.btn-warning {
background: linear-gradient(45deg, #f39c12, #e67e22);
border: none;
color: white;
}
.btn-danger {
background: linear-gradient(45deg, #e74c3c, #c0392b);
border: none;
color: white;
}
/* è¿›åº¦æ¡æ ·å¼ä¼˜åŒ– */
.progress {
height: 10px !important;
border-radius: 5px;
background-color: #f5f6fa;
overflow: hidden;
margin: 0.5rem 0 !important;
}
.progress-bar {
background: linear-gradient(to right, #3498db, #2980b9);
transition: width 0.6s ease;
}
.progress-bar.bg-danger {
background: linear-gradient(to right, #e74c3c, #c0392b);
}
/* æ–‡å­—æ ·å¼ä¼˜åŒ– */
.text-muted {
color: #7f8c8d !important;
font-size: 0.85rem !important;
}
.small {
font-size: 0.9rem !important;
color: #34495e;
}
/* ç›®æ ‡å¡ç‰‡å¸ƒå±€ä¼˜åŒ– */
.goal-container {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
gap: 1rem !important;
padding: 1rem !important;
}
/* å†å²è®°å½•å’Œå½’æ¡£è®°å½•æ ·å¼ */
.card-body p-2 {
padding: 0.75rem !important;
}
/* æŒ‰é’®ç»„æ ·å¼ä¼˜åŒ– */
.btn-group {
box-shadow: 0 2px 4px rgba(0,0,0,0.05);
border-radius: 6px;
overflow: hidden;
}
.btn-group .btn {
border: none;
padding: 0.4rem 0.8rem;
}
/* æ€»å­˜æ¬¾é‡‘é¢æ˜¾ç¤ºä¼˜åŒ– */
.text-success {
color: #2ecc71 !important;
font-weight: 600;
}
/* å“åº”å¼ä¼˜åŒ– */
@media (max-width: 768px) {
.container {
padding: 1rem;
}
.goal-container {
grid-template-columns: 1fr;
}
.card-header {
padding: 1rem;
}
}
/* æ•´ä½“å¸ƒå±€ä¼˜åŒ– */
.container {
max-width: 1200px;
padding: 1rem;
}
/* å·¦ä¾§è®¾ç½®åŒºåŸŸä¼˜åŒ– */
.card {
border: none;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0,0,0,0.08);
margin-bottom: 0.75rem !important;
}
.card-header {
background: #f8f9fa;
border-bottom: 1px solid rgba(0,0,0,0.05);
padding: 0.75rem 1rem;
}
/* è¡¨å•æ ·å¼ä¼˜åŒ– */
.form-control {
font-size: 0.85rem;
padding: 0.35rem 0.5rem;
border-radius: 6px;
height: auto;
}
.form-label {
font-size: 0.85rem;
color: #4a5568;
margin-bottom: 0.25rem;
text-align: center;  /* å±…ä¸­æ ‡ç­¾ */
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.btn {
font-size: 0.85rem !important;
padding: 0.35rem 0.5rem;
height: auto;
}
.btn-sm {
font-size: 0.75rem !important;
padding: 0.2rem 0.4rem;
}
/* å­—ä½“ä¼˜åŒ– */
body {
font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
color: #2d3748;
line-height: 1.4;
}
.card-title {
font-size: 0.95rem !important;
font-weight: 500;
color: #2d3748;
margin: 0;
}
.text-muted {
color: #718096 !important;
font-size: 0.8rem !important;
}
.small {
font-size: 0.85rem !important;
color: #4a5568;
}
/* è¿›åº¦æ¡æ ·å¼ä¼˜åŒ– */
.progress {
height: 8px !important;
border-radius: 4px;
background-color: #edf2f7;
margin: 0.4rem 0 !important;
}
.progress-bar {
font-size: 0.75rem !important;
background: #4299e1;
}
/* ç›®æ ‡å¡ç‰‡å¸ƒå±€ä¼˜åŒ– */
.goal-container {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
gap: 0.75rem;
padding: 0.75rem;
}
/* æ€»å­˜æ¬¾æ˜¾ç¤ºä¼˜åŒ– */
.text-success {
color: #38a169 !important;
font-weight: 500;
}
h3.text-success {
font-size: 1.25rem;
margin-top: 1rem;
}
/* å“åº”å¼ä¼˜åŒ– */
@media (max-width: 768px) {
.container {
padding: 0.75rem;
}
.card-header {
padding: 0.75rem;
}
.btn-group .btn {
padding: 0.3rem 0.5rem;
font-size: 0.8rem !important;
}
}
/* æ›´æ–°å·¦ä¾§è®¾ç½®åŒºåŸŸçš„æ ·å¼ */
.card {
border: none;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0,0,0,0.08);
margin-bottom: 0.75rem !important;
}
.card-header {
background: #f8f9fa;
border-bottom: 1px solid rgba(0,0,0,0.05);
padding: 0.5rem 0.75rem;
text-align: center;  /* å±…ä¸­æ ‡é¢˜ */
}
.card-body {
padding: 0.75rem !important;
}
/* è¡¨å•æ ·å¼ä¼˜åŒ– */
.form-control {
font-size: 0.85rem;
padding: 0.35rem 0.5rem;
border-radius: 6px;
height: auto;
}
.form-label {
font-size: 0.85rem;
color: #4a5568;
margin-bottom: 0.25rem;
text-align: center;  /* å±…ä¸­æ ‡ç­¾ */
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.btn {
font-size: 0.85rem !important;
padding: 0.35rem 0.5rem;
height: auto;
}
.btn-sm {
font-size: 0.75rem !important;
padding: 0.2rem 0.4rem;
}
/* å­—ä½“ä¼˜åŒ– */
body {
font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
color: #2d3748;
line-height: 1.4;
}
.card-title {
font-size: 0.95rem !important;
font-weight: 500;
color: #2d3748;
margin: 0;
}
/* é—´è·ä¼˜åŒ– */
.mb-3 {
margin-bottom: 0.75rem !important;
}
.mb-2 {
margin-bottom: 0.5rem !important;
}
/* å­˜å–æ¬¾è¡¨å•ä¼˜åŒ– */
#depositForm, #withdrawForm {
text-align: center;  /* å±…ä¸­è¡¨å•å†…å®¹ */
}
/* æ€»å­˜æ¬¾æ˜¾ç¤ºä¼˜åŒ– */
.text-center.mt-4 {
margin-top: 0.75rem !important;
}
h3.text-success {
font-size: 1.1rem;
margin: 0;
}
/* è¿›åº¦æ¡å®¹å™¨ä¼˜åŒ– */
.goal-container {
gap: 0.5rem;
padding: 0.5rem;
}
/* è¿›åº¦æ¡å¡ç‰‡ä¼˜åŒ– */
.card.mb-3 {
margin-bottom: 0.5rem !important;
}
/* å“åº”å¼ä¼˜åŒ– */
@media (max-width: 768px) {
.container {
padding: 0.5rem;
}
.card-header {
padding: 0.5rem;
}
.card-body {
padding: 0.5rem !important;
}
}
/* å¹´é¾„ç›®æ ‡åˆ†ç±»æ ·å¼ */
.age-goals-section {
margin-bottom: 1rem;
}
.age-category-title {
font-size: 0.9rem;
font-weight: 500;
color: #4a5568;
margin: 0.5rem 0;
padding: 0 0.5rem;
}
/* å¹´é¾„ç›®æ ‡å¡ç‰‡å®¹å™¨ */
.age-goals-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
gap: 0.35rem;  /* å‡å°å¡ç‰‡ä¹‹é—´çš„é—´è· */
padding: 0 0.35rem;  /* å‡å°å·¦å³å†…è¾¹è· */
}
/* å¹´é¾„ç›®æ ‡å¡ç‰‡æ ·å¼ä¼˜åŒ– */
.age-goal-card {
border: none;
border-radius: 12px;
background: #ffffff;
box-shadow: 0 2px 8px rgba(0,0,0,0.08);
transition: all 0.3s ease;
margin-bottom: 0.75rem;
}
/* ä»Šå¹´è¿›åº¦å¡ç‰‡æ ·å¼ */
.age-goal-card.yearly {
border-left: 4px solid #e74c3c;
background: linear-gradient(to right, rgba(231, 76, 60, 0.05), transparent);
}
.age-goal-card.yearly .goal-name::before {
content: "ğŸ“…";
margin-right: 8px;
}
.age-goal-card.yearly .progress-bar {
background: linear-gradient(45deg, #e74c3c, #c0392b);
}
/* äººç”Ÿè¿›åº¦å¡ç‰‡æ ·å¼ */
.age-goal-card.lifetime {
border-left: 4px solid #3498db;
background: linear-gradient(to right, rgba(52, 152, 219, 0.05), transparent);
}
.age-goal-card.lifetime .goal-name::before {
content: "ğŸŒŸ";
margin-right: 8px;
}
.age-goal-card.lifetime .progress-bar {
background: linear-gradient(45deg, #f39c12, #e67e22) !important;
}
/* åˆ†ç±»æ ‡é¢˜æ ·å¼ä¼˜åŒ– */
.age-category-title {
font-size: 1rem;
font-weight: 600;
color: #2d3748;
margin: 1rem 0 0.75rem;
padding: 0.5rem 1rem;
border-radius: 8px;
display: flex;
align-items: center;
gap: 0.5rem;
}
.age-category-title.yearly {
background: rgba(231, 76, 60, 0.1);
color: #c0392b;
}
.age-category-title.yearly::before {
content: "ğŸ“…";
}
.age-category-title.lifetime {
background: rgba(52, 152, 219, 0.1);
color: #2980b9;
}
.age-category-title.lifetime::before {
content: "ğŸŒŸ";
}
.age-goal-card .card-body {
padding: 0.5rem !important;  /* å‡å°å¡ç‰‡å†…è¾¹è· */
}
.age-goal-info {
display: flex;
flex-direction: column;
gap: 0.25rem;  /* å‡å°å†…éƒ¨å…ƒç´ é—´è· */
margin-bottom: 0.5rem;  /* å‡å°åº•éƒ¨é—´è· */
}
.goal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 0.25rem;  /* æ·»åŠ å°é—´è· */
}
.goal-name {
font-size: 1rem;  /* ç¨å¾®å‡å°å­—å· */
font-weight: 600;
color: #2d3748;
}
.age-range {
display: flex;
align-items: center;
gap: 0.35rem;  /* å‡å°é—´è· */
color: #4a5568;
font-size: 0.85rem;  /* å‡å°å­—å· */
}
.time-info {
display: flex;
justify-content: space-between;
align-items: center;
background: #f7fafc;
padding: 0.35rem 0.5rem;  /* å‡å°å†…è¾¹è· */
border-radius: 4px;
margin-top: 0.25rem;  /* å‡å°é¡¶éƒ¨é—´è· */
}
.remaining-days {
display: flex;
align-items: center;
gap: 0.35rem;
color: #4a5568;
font-size: 0.85rem;
}
.progress-section {
margin: 0.5rem 0;  /* å‡å°ä¸Šä¸‹é—´è· */
}
.progress {
height: 0.6rem !important;  /* å‡å°è¿›åº¦æ¡é«˜åº¦ */
margin: 0.25rem 0;  /* å‡å°ä¸Šä¸‹é—´è· */
}
.age-goal-actions {
display: flex;
justify-content: flex-end;
gap: 0.35rem;  /* å‡å°æŒ‰é’®é—´è· */
margin-top: 0.5rem;  /* å‡å°é¡¶éƒ¨é—´è· */
}
.age-goal-actions .btn {
padding: 0.25rem 0.5rem;  /* å‡å°æŒ‰é’®å†…è¾¹è· */
font-size: 0.8rem;  /* å‡å°æŒ‰é’®å­—å· */
}
/* æŒ‰é’®å›¾æ ‡æ ·å¼ */
.btn-icon {
font-size: 0.8rem;  /* å‡å°å›¾æ ‡å¤§å° */
}
/* å½’æ¡£åˆ†ç±»æ ‡é¢˜æ ·å¼ */
.archive-category-title {
font-size: 0.9rem;
font-weight: 500;
color: #4a5568;
margin: 1rem 0 0.75rem 0.5rem;
padding-bottom: 0.25rem;
border-bottom: 1px solid #e2e8f0;
}
/* å½’æ¡£å¡ç‰‡å®¹å™¨ */
.archive-grid {
display: flex;
flex-direction: column;
gap: 0.5rem;
}
/* å½’æ¡£å¡ç‰‡æ ·å¼ */
.archive-card {
background: #fff;
border: 1px solid #e2e8f0;
border-radius: 8px;
margin-bottom: 0.5rem;
padding: 0.75rem;
}
.archive-card .card-body {
padding: 0 !important;
}
/* å½’æ¡£ä¿¡æ¯å¸ƒå±€ */
.archive-info {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 0.25rem;
}
.archive-name {
font-weight: 500;
color: #2d3748;
font-size: 0.9rem;
}
.archive-target {
color: #718096;
font-size: 0.85rem;
}
.archive-date {
color: #a0aec0;
font-size: 0.8rem;
}
/* æ¢å¤æŒ‰é’®æ ·å¼ */
.btn-restore {
font-size: 0.8rem;
padding: 0.2rem 0.5rem;
background-color: #3498db;
color: white;
border: none;
border-radius: 4px;
}
/* ç©ºçŠ¶æ€æç¤º */
.text-muted.small {
color: #a0aec0 !important;
font-size: 0.85rem;
text-align: center;
padding: 1rem;
}
/* å“åº”å¼å¸ƒå±€ */
@media (max-width: 768px) {
.archive-container {
grid-template-columns: 1fr;
gap: 1rem;
}
}
/* æç¤ºæ¡†æ ·å¼ */
.toast {
position: fixed;
bottom: 20px;
left: 50%;
transform: translateX(-50%);
background: rgba(0, 0, 0, 0.8);
color: white;
padding: 8px 16px;
border-radius: 4px;
font-size: 0.9rem;
z-index: 1000;
}
/* æŒ‰é’®ç»„æ ·å¼ */
.btn-group {
display: flex;
gap: 0.5rem;
margin-bottom: 1rem;
}
.btn-warning {
background-color: #f39c12;
border: none;
color: white;
}
.btn-warning:hover {
background-color: #e67e22;
}
/* æŒ‰é’®ç»„æ ·å¼ä¼˜åŒ– */
.action-buttons {
display: flex;
gap: 0.5rem;
padding: 0.75rem;
background: #f8f9fa;
border-radius: 8px;
margin-bottom: 1rem;
}
.action-buttons .btn {
flex: 1;
padding: 0.5rem;
font-size: 0.9rem;
border-radius: 4px;
border: none;
}
/* å¯¼å…¥å¯¼å‡ºæŒ‰é’®ç»„ */
.io-buttons {
display: flex;
gap: 0.5rem;
}
.io-buttons .btn {
background-color: #3498db;
color: white;
}
/* é‡ç½®æŒ‰é’®ç»„ */
.reset-buttons {
display: flex;
gap: 0.5rem;
}
.reset-buttons .btn {
background-color: #e74c3c;
color: white;
}
/* æ¸…ç©ºæŒ‰é’®ç»„ */
.clear-buttons {
display: flex;
gap: 0.5rem;
}
.clear-buttons .btn {
background-color: #f39c12;
color: white;
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.btn-sm {
padding: 0.25rem 0.5rem;
font-size: 0.85rem;
}
.btn-primary {
background-color: #3498db;
border: none;
}
.btn-success {
background-color: #2ecc71;
border: none;
}
.btn-warning {
background-color: #f39c12;
border: none;
color: white;
}
.btn-danger {
background-color: #e74c3c;
border: none;
}
/* ç»Ÿä¸€æŒ‰é’®æ‚¬åœæ•ˆæœ */
.btn:hover {
transform: translateY(-1px);
transition: transform 0.2s ease;
}
/* ä¿®æ”¹æŒ‰é’®å’Œè¿›åº¦æ¡çš„é¢œè‰²æ ·å¼ */
/* å­˜æ¬¾ç›¸å…³æŒ‰é’®ä½¿ç”¨ç»¿è‰²ç³» */
.btn-success,
button[type="submit"]:contains("å­˜") {
background-color: #2ecc71 !important;
border-color: #27ae60 !important;
}
/* å–æ¬¾ç›¸å…³æŒ‰é’®ä½¿ç”¨æ©™è‰²ç³» */
.btn-warning,
button[type="submit"]:contains("å–") {
background-color: #e67e22 !important;
border-color: #d35400 !important;
color: white !important;
}
/* é‡ç½®å’Œåˆ é™¤æŒ‰é’®ä½¿ç”¨çº¢è‰²ç³» */
.btn-danger {
background-color: #e74c3c !important;
border-color: #c0392b !important;
}
/* å¯¼å…¥å¯¼å‡ºå’Œæ™®é€šåŠŸèƒ½æŒ‰é’®ä½¿ç”¨è“è‰²ç³» */
.btn-primary {
background-color: #3498db !important;
border-color: #2980b9 !important;
}
/* ç»Ÿä¸€éå±é™©è¿›åº¦æ¡æ ·å¼ */
.progress-bar:not(.bg-danger):not(.age-goal-card.lifetime .progress-bar) {
background: linear-gradient(to right, #3498db, #2980b9) !important;
}
/* å¹´é¾„ç›®æ ‡è¿›åº¦æ¡ */
/* ä»Šå¹´è¿›åº¦ä½¿ç”¨çº¢è‰²ç³» */
.progress-bar.bg-danger {
background: linear-gradient(to right, #e74c3c, #c0392b) !important;
}
/* å½’æ¡£æŒ‰é’®ä½¿ç”¨ç´«è‰²ç³» */
.btn-success[onclick*="archive"] {
background-color: #9b59b6 !important;
border-color: #8e44ad !important;
}
/* æ¢å¤æŒ‰é’®ä½¿ç”¨é’è‰²ç³» */
.btn-primary[onclick*="restore"] {
background-color: #1abc9c !important;
border-color: #16a085 !important;
}
/* ç¼–è¾‘æŒ‰é’®ä½¿ç”¨æµ…è“è‰²ç³» */
.btn-primary[onclick*="edit"] {
background-color: #00bcd4 !important;
border-color: #0097a7 !important;
}
/* è§†å›¾åˆ‡æ¢æŒ‰é’®ç»„æ ·å¼ */
.btn-outline-primary {
color: #3498db !important;
border-color: #3498db !important;
}
.btn-outline-primary:hover,
.btn-check:checked + .btn-outline-primary {
color: white !important;
background-color: #3498db !important;
}
/* æŒ‰é’®æ‚¬åœæ•ˆæœä¼˜åŒ– */
.btn:hover {
transform: translateY(-1px);
transition: transform 0.2s ease;
}
/* è¿›åº¦æ¡åŠ¨ç”»æ•ˆæœ */
.progress-bar {
transition: width 0.6s ease-in-out;
}
/* ç»Ÿä¸€ä¸»è¦æŒ‰é’®æ ·å¼ */
.btn-primary {
background-color: #3498db !important;
border-color: #2980b9 !important;
}
/* å››è±¡é™å¾…åŠäº‹é¡¹æ ·å¼ */
.quadrant-grid {
display: grid;
grid-template-columns: minmax(350px, 1fr) minmax(350px, 1fr);
grid-template-rows: repeat(2, minmax(300px, 1fr));
gap: 1.5rem;
padding: 1rem;
min-height: 800px;
height: auto;
max-width: 1600px;
margin: 0 auto;
}
.quadrant {
border: 2px solid;
border-radius: 10px;
padding: 20px;
margin: 10px;
min-height: 300px;
position: relative;
display: flex;
flex-direction: column;
}
/* å“åº”å¼å¸ƒå±€è°ƒæ•´ */
@media (max-width: 1200px) {
.quadrant-grid {
grid-template-columns: minmax(300px, 1fr) minmax(300px, 1fr);
gap: 1rem;
}
.quadrant {
min-height: 250px;
}
}
@media (max-width: 768px) {
.quadrant-grid {
grid-template-columns: 1fr;
gap: 1rem;
}
.quadrant {
min-height: 250px;
}
}
.card-body {
padding: 0.5rem !important;
}
.goal-container {
max-width: 100%;
margin: 0 auto;
}
/* ä¼˜åŒ–å››è±¡é™å†…éƒ¨å¸ƒå±€ */
.quadrant {
border: 2px solid;
border-radius: 10px;
padding: 15px;
margin: 10px;
min-height: 200px;
position: relative;
display: flex;
flex-direction: column;
}
/* å››ä¸ªè±¡é™çš„ä¸åŒé¢œè‰² */
.quadrant-1 {
border-color: #e74c3c;  /* çº¢è‰² - é‡è¦ä¸”ç´§æ€¥ */
}
.quadrant-1 .quadrant-title {
color: #e74c3c;
font-weight: bold;
margin-bottom: 15px;
}
.quadrant-2 {
border-color: #3498db;  /* è“è‰² - é‡è¦ä¸ç´§æ€¥ */
}
.quadrant-2 .quadrant-title {
color: #3498db;
font-weight: bold;
margin-bottom: 15px;
}
.quadrant-3 {
border-color: #2ecc71;  /* ç»¿è‰² - ç´§æ€¥ä¸é‡è¦ */
}
.quadrant-3 .quadrant-title {
color: #2ecc71;
font-weight: bold;
margin-bottom: 15px;
}
.quadrant-4 {
border-color: #f1c40f;  /* é»„è‰² - ä¸é‡è¦ä¸ç´§æ€¥ */
}
.quadrant-4 .quadrant-title {
color: #f1c40f;
font-weight: bold;
margin-bottom: 15px;
}
/* æ·»åŠ æ·¡è‰²èƒŒæ™¯ */
.quadrant-1 { background-color: rgba(231, 76, 60, 0.05); }
.quadrant-2 { background-color: rgba(52, 152, 219, 0.05); }
.quadrant-3 { background-color: rgba(46, 204, 113, 0.05); }
.quadrant-4 { background-color: rgba(241, 196, 15, 0.05); }
.quadrant-header {
margin-bottom: 1rem;
}
.todo-list {
flex: 1;
overflow-y: auto;
margin-bottom: 0.75rem;
}
.add-todo {
margin-top: auto;
padding-top: 0.75rem;
}
.quadrant-title {
font-size: 1rem;
font-weight: 500;
color: #2d3748;
margin: 0;
}
.todo-item {
display: flex;
align-items: center;
gap: 0.5rem;
padding: 0.5rem;
border-bottom: 1px solid #f0f2f5;
}
.todo-item:last-child {
border-bottom: none;
}
.todo-checkbox {
width: 18px;
height: 18px;
}
.todo-text {
flex: 1;
font-size: 0.9rem;
color: #4a5568;
}
.todo-text.completed {
text-decoration: line-through;
color: #a0aec0;
}
.todo-actions {
display: flex;
gap: 0.5rem;
}
.quadrant-1 {
border-color: #e74c3c;
}
.quadrant-2 {
border-color: #3498db;
}
.quadrant-3 {
border-color: #2ecc71;
}
.quadrant-4 {
border-color: #f1c40f;
}
.quadrant-header.quadrant-1 {
color: #e74c3c;
}
.quadrant-header.quadrant-2 {
color: #3498db;
}
.quadrant-header.quadrant-3 {
color: #2ecc71;
}
.quadrant-header.quadrant-4 {
color: #f1c40f;
}
.add-todo {
display: flex;
gap: 0.5rem;
margin-top: 0.5rem;
}
.add-todo input {
flex: 1;
padding: 0.25rem 0.5rem;
border: 1px solid #e2e8f0;
border-radius: 4px;
font-size: 0.9rem;
}
.add-todo button {
padding: 0.25rem 0.5rem;
font-size: 0.9rem;
}
/* è¿›åº¦æ¡å’Œé‡‘é¢æ˜¾ç¤ºä¼˜åŒ– */
.progress-wrapper {
position: relative;
background: #f8fafc;
border-radius: 10px;
padding: 1.25rem;
margin: 1rem 0;
box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
}
.amount-display-wrapper {
display: flex;
justify-content: space-between;
margin-bottom: 0.75rem;
}
.amount-item {
text-align: center;
}
.amount-label {
font-size: 0.85rem;
color: #64748b;
margin-bottom: 0.25rem;
}
.amount-value {
font-size: 1.25rem;
font-weight: 600;
color: #1a202c;
}
.amount-value.current {
color: #3182ce;
}
.amount-value.target {
color: #2d3748;
}
.progress {
height: 1.25rem !important;
background: #e2e8f0;
border-radius: 0.75rem;
margin: 0.75rem 0;
overflow: hidden;
box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
}
.progress-bar {
background: linear-gradient(45deg, #3182ce, #4299e1);
position: relative;
transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.progress-bar.high {
background: linear-gradient(45deg, #48bb78, #68d391);
}
.progress-bar.medium {
background: linear-gradient(45deg, #ecc94b, #f6e05e);
}
.progress-bar.low {
background: linear-gradient(45deg, #f56565, #fc8181);
}
.progress-text {
position: absolute;
left: 50%;
top: 50%;
transform: translate(-50%, -50%);
color: white;
font-weight: 600;
font-size: 0.875rem;
text-shadow: 0 1px 2px rgba(0,0,0,0.1);
white-space: nowrap;
}
.progress-details {
display: flex;
justify-content: space-between;
font-size: 0.875rem;
color: #718096;
margin-top: 0.5rem;
}
.remaining-amount {
color: #e53e3e;
font-weight: 500;
}
/* è¿›åº¦æ¡åŠ¨ç”»æ•ˆæœ */
@keyframes progressFill {
from { transform: translateX(-100%); }
to { transform: translateX(0); }
}
.progress-bar {
animation: progressFill 1s ease-out forwards;
}
/* ç›®æ ‡åç§°æ ·å¼ */
.goal-name {
font-size: 1rem;
font-weight: 600;
color: #1a365d;  /* æ·±è“è‰²ï¼Œæ›´é†’ç›® */
}
/* å¹´é¾„åŒºé—´æ ·å¼ */
.age-range {
display: flex;
align-items: center;
gap: 0.35rem;
color: #4a5568;
font-size: 0.85rem;
}
.age-range span {
color: #2c5282;  /* è“è‰²ï¼Œçªå‡ºå¹´é¾„æ•°å­— */
font-weight: 500;
}
.age-arrow {
color: #a0aec0;  /* æµ…ç°è‰²ç®­å¤´ */
font-weight: normal;
}
/* å‰©ä½™å¤©æ•°æ ·å¼ */
.remaining-days {
display: flex;
align-items: center;
gap: 0.35rem;
}
.remaining-days i {
color: #718096;  /* å›¾æ ‡é¢œè‰² */
}
.days-count {
color: #e53e3e;  /* çº¢è‰²çªå‡ºæ˜¾ç¤ºå¤©æ•° */
font-weight: 600;
font-size: 0.9rem;
}
.days-label {
color: #718096;  /* æµ…ç°è‰²æ–‡å­— */
font-size: 0.8rem;
}
/* æ—¶é—´è¿›åº¦å€¼æ ·å¼ */
.time-value {
font-size: 0.8rem;
font-weight: 500;
}
.time-value.urgent {
color: #c53030;  /* æ·±çº¢è‰² */
}
.time-value.warning {
color: #b7791f;  /* æ·±æ©™è‰² */
}
.time-value.normal {
color: #2b6cb0;  /* æ·±è“è‰² */
}
/* è¿›åº¦æ¡æ ·å¼ä¼˜åŒ– */
.progress-bar {
background: linear-gradient(45deg, #4299e1, #63b3ed);  /* è“è‰²æ¸å˜ */
}
/* åˆ†ç±»æ ‡é¢˜æ ·å¼ */
.age-category-title {
font-size: 0.85rem;
font-weight: 600;
color: #2d3748;  /* æ·±ç°è‰² */
margin: 0.35rem 0;
padding: 0 0.35rem;
}
/* æŒ‰é’®æ–‡å­—é¢œè‰² */
.age-goal-actions .btn {
color: #ffffff;  /* ç™½è‰²æŒ‰é’®æ–‡å­— */
}
.age-goal-actions .btn-icon {
color: #ffffff;  /* ç™½è‰²å›¾æ ‡ */
}
/* å¹´é¾„ç›®æ ‡å¡ç‰‡æ ·å¼ä¼˜åŒ– */
.age-goal-card .card-body {
padding: 0.5rem !important;
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.age-goal-card .btn-sm {
padding: 0.15rem 0.35rem !important;
font-size: 0.75rem !important;
line-height: 1.2;
border-radius: 4px;
}
.age-goal-card .btn-icon {
font-size: 0.7rem;
margin-right: 0.15rem;
}
/* å†…å®¹å¸ƒå±€ä¼˜åŒ– */
.age-goal-info {
margin-top: 0.35rem;
}
.age-range {
margin-bottom: 0.35rem;
}
/* è¿›åº¦æ¡åŒºåŸŸä¼˜åŒ– */
.progress-section {
margin: 0.35rem 0 0 0;
}
.progress {
margin: 0;
height: 0.5rem !important;
}
/* çµæ„Ÿç®¡ç†æ ·å¼ */
.inspiration-container {
padding: 1rem;
}
.inspiration-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1rem;
}
.inspiration-search {
position: relative;
max-width: 300px;
}
.inspiration-search input {
width: 100%;
padding: 0.5rem 1rem;
border-radius: 20px;
border: 1px solid #e2e8f0;
padding-left: 2.5rem;
}
.inspiration-search i {
position: absolute;
left: 1rem;
top: 50%;
transform: translateY(-50%);
color: #718096;
}
/* ä¿®æ”¹æ ‡ç­¾æŒ‰é’®æ ·å¼ */
.inspiration-filters {
display: flex;
align-items: center;
gap: 0.5rem;
margin: 1rem 0;
padding: 0.5rem;
background: #fff;
border-radius: 8px;
overflow-x: auto;
white-space: nowrap;
}
.tag-buttons {
display: flex;
gap: 0.5rem;
}
.tag-btn {
padding: 0.35rem 1rem;
border: none;
background: #f0f2f5;
color: #666;
font-size: 0.875rem;
border-radius: 16px;
cursor: pointer;
transition: all 0.2s ease;
outline: none;
}
.tag-btn:hover {
background: #e4e6eb;
color: #333;
}
.tag-btn.active {
background: #e6f3ff;
color: #1890ff;
}
/* é€‚é…ç§»åŠ¨ç«¯ */
@media (max-width: 768px) {
.inspiration-filters {
padding: 0.5rem;
margin: 0.5rem 0;
}
.tag-btn {
padding: 0.25rem 0.75rem;
font-size: 0.8rem;
}
}
.inspiration-list {
min-height: 200px;
}
/* çµæ„Ÿåˆ—è¡¨é¡¹æ ·å¼ä¼˜åŒ– */
.inspiration-item {
background: white;
border-radius: 8px;
padding: 1rem;
margin-bottom: 0.5rem;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
cursor: move;
transition: all 0.2s;
position: relative;
display: flex;
flex-direction: column;
gap: 0.5rem;
width: 100%;
}
.inspiration-header-row {
display: flex;
align-items: flex-start;
gap: 1rem;
width: 100%;
}
.inspiration-number {
font-weight: 600;
color: #2d3748;
min-width: 30px;
text-align: center;
padding-top: 2px;
}
.inspiration-content {
flex: 1;
min-width: 0;
width: 100%;
}
.inspiration-text {
color: #4a5568;
margin: 0;
white-space: pre-wrap;
word-break: break-word;
line-height: 1.5;
padding: 4px 0;
}
.inspiration-footer {
display: flex;
justify-content: space-between;
align-items: center;
margin-top: 0.5rem;
flex-wrap: wrap;
gap: 0.5rem;
}
.inspiration-info {
display: flex;
flex-direction: column;
gap: 0.25rem;
}
.inspiration-tags {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
}
.inspiration-tag {
background: #e2e8f0;
color: #4a5568;
padding: 0.2rem 0.5rem;
border-radius: 1rem;
font-size: 0.75rem;
white-space: nowrap;
}
.inspiration-time {
color: #718096;
font-size: 0.75rem;
}
.inspiration-actions {
display: flex;
gap: 0.5rem;
margin-left: auto;
}
.inspiration-actions button {
padding: 0.15rem 0.5rem;
font-size: 0.75rem;
border: none;
border-radius: 4px;
cursor: pointer;
transition: all 0.2s;
min-width: 45px;
height: 24px;
line-height: 1;
display: inline-flex;
align-items: center;
justify-content: center;
}
.inspiration-actions .btn-edit {
background: linear-gradient(45deg, #3498db, #2980b9);
color: white;
}
.inspiration-actions .btn-delete {
background: linear-gradient(45deg, #e74c3c, #c0392b);
color: white;
}
.inspiration-actions button:hover {
transform: translateY(-1px);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.inspiration-actions button i {
font-size: 0.75rem;
margin-right: 2px;
}
.dragging {
opacity: 0.5;
background: #f7fafc;
}
.tag-selection {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
margin-top: 0.5rem;
}
.tag-list {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
margin-top: 0.5rem;
}
.tag-item {
display: flex;
align-items: center;
gap: 0.5rem;
background: #e2e8f0;
padding: 0.25rem 0.75rem;
border-radius: 1rem;
}
.tag-item button {
padding: 0;
width: 1.2rem;
height: 1.2rem;
display: flex;
align-items: center;
justify-content: center;
border-radius: 50%;
}
.inspiration-filter {
cursor: pointer;
padding: 0.25rem 0.75rem;
border-radius: 1rem;
background: #e2e8f0;
color: #4a5568;
transition: all 0.2s;
}
.inspiration-filter.active {
background: #3498db;
color: white;
}
/* æ ‡ç­¾æŒ‰é’®æ ·å¼ */
.tag-btn {
padding: 0.35rem 1rem;
border: none;
background: #f0f2f5;
color: #666;
font-size: 0.875rem;
border-radius: 16px;
cursor: pointer;
transition: all 0.2s ease;
outline: none;
}
.tag-btn:hover {
background: #e4e6eb;
color: #333;
}
.tag-btn.active {
background: #e6f3ff;
color: #1890ff;
}
/* æ ‡ç­¾ç®¡ç†æ ·å¼ */
.tag-selection {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
margin-top: 0.5rem;
}
.tag-list {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
margin-top: 0.5rem;
}
.tag-item {
display: flex;
align-items: center;
gap: 0.5rem;
background: #e2e8f0;
padding: 0.25rem 0.75rem;
border-radius: 1rem;
}
.tag-item button {
padding: 0;
width: 1.2rem;
height: 1.2rem;
display: flex;
align-items: center;
justify-content: center;
border-radius: 50%;
border: none;
background: rgba(0,0,0,0.1);
color: #666;
cursor: pointer;
transition: all 0.2s ease;
}
.tag-item button:hover {
background: rgba(0,0,0,0.2);
color: #333;
}
/* æ ‡ç­¾ç®¡ç†æ¨¡æ€æ¡†æ ·å¼ */
.current-tags {
margin-top: 1rem;
padding-top: 1rem;
border-top: 1px solid #e2e8f0;
}
.current-tags .form-label {
margin-bottom: 0.75rem;
color: #4a5568;
font-weight: 500;
}
/* æ·»åŠ æ ‡ç­¾è¾“å…¥æ¡†ç»„æ ·å¼ */
.input-group {
display: flex;
gap: 0.5rem;
}
.input-group .form-control {
flex: 1;
border-radius: 0.375rem;
}
.input-group .btn {
white-space: nowrap;
border-radius: 0.375rem;
}
.add-todo-container {
position: absolute;
bottom: 15px;
left: 15px;
right: 15px;
display: flex;
gap: 10px;
width: calc(100% - 30px); /* è®¾ç½®å®¹å™¨å®½åº¦ */
}
.add-todo-input {
flex: 1;
padding: 6px 12px;
border: 1px solid #ced4da;
border-radius: 4px;
min-width: 200px; /* è®¾ç½®æœ€å°å®½åº¦ */
width: calc(100% - 65px); /* å‡å»æŒ‰é’®å®½åº¦å’Œé—´è· */
}
.add-todo-btn {
width: 55px;
padding: 6px 12px;
background-color: #0d6efd;
color: white;
border: none;
border-radius: 4px;
cursor: pointer;
white-space: nowrap;
}
.inspiration-container {
width: 100%;
max-width: 1200px;
margin: 0 auto;
padding: 1rem;
}
/* çµæ„Ÿé¡µé¢æ•´ä½“å¸ƒå±€ */
.inspiration-wrapper {
width: 100%;
max-width: 800px;
margin: 0 auto;
padding: 1rem;
box-sizing: border-box;
}
/* çµæ„Ÿåˆ—è¡¨å¸ƒå±€ */
.inspiration-grid {
display: flex;
flex-direction: column;
gap: 0.15rem;  /* å‡å°çµæ„Ÿå¡ç‰‡ä¹‹é—´çš„é—´è· */
padding: 0.15rem 0;
}
/* çµæ„Ÿå¡ç‰‡æ ·å¼ä¼˜åŒ– */
.inspiration-item {
background: white;
border-radius: 4px;  /* å‡å°åœ†è§’ */
padding: 0.25rem;  /* å‡å°å†…è¾¹è· */
box-shadow: 0 1px 2px rgba(0,0,0,0.05);
border: 1px solid #eee;
width: 100%;
}
/* çµæ„Ÿå†…å®¹å¸ƒå±€ä¼˜åŒ– */
.inspiration-header-row {
display: flex;
align-items: flex-start;
gap: 0.25rem;  /* å‡å°åºå·ä¸å†…å®¹çš„é—´è· */
margin-bottom: 0.15rem;  /* å‡å°ä¸åº•éƒ¨çš„é—´è· */
}
/* åºå·æ ·å¼ä¼˜åŒ– */
.inspiration-number {
font-size: 0.8rem;
color: #666;
min-width: 20px;
text-align: center;
background: #f5f5f5;
border-radius: 2px;
padding: 0.1rem 0.2rem;
}
/* åº•éƒ¨ä¿¡æ¯æ ·å¼ä¼˜åŒ– */
.inspiration-footer {
display: flex;
justify-content: space-between;
align-items: center;
margin-top: 0.15rem;  /* å‡å°ä¸å†…å®¹çš„é—´è· */
font-size: 0.8rem;
}
/* æ ‡ç­¾æ ·å¼ä¼˜åŒ– */
.inspiration-tag {
background: #f0f0f0;
color: #666;
padding: 0.05rem 0.25rem;  /* å‡å°æ ‡ç­¾å†…è¾¹è· */
border-radius: 2px;
font-size: 0.75rem;
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.inspiration-actions button {
padding: 0.1rem 0.25rem;  /* å‡å°æŒ‰é’®å†…è¾¹è· */
font-size: 0.75rem;
gap: 0.15rem;
}
/* æ—¶é—´æ˜¾ç¤ºä¼˜åŒ– */
.inspiration-time {
font-size: 0.75rem;
}
/* æœç´¢æ¡†æ ·å¼ä¼˜åŒ– */
.inspiration-search {
position: relative;
width: 100%;
max-width: 300px;
}
.inspiration-search input {
width: 100%;
padding: 0.4rem 0.75rem 0.4rem 2rem;
border: 1px solid #ddd;
border-radius: 4px;
font-size: 0.9rem;
}
.inspiration-search i {
position: absolute;
left: 0.75rem;
top: 50%;
transform: translateY(-50%);
color: #999;
}
/* æ ‡ç­¾æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.tag-buttons {
display: flex;
flex-wrap: wrap;
gap: 0.35rem;
}
.tag-btn {
padding: 0.25rem 0.5rem;
font-size: 0.85rem;
border: 1px solid #ddd;
border-radius: 3px;
background: white;
cursor: pointer;
transition: all 0.2s ease;
}
.tag-btn.active {
background: #3498db;
color: white;
border-color: #3498db;
}
/* è¿›ä¸€æ­¥ä¼˜åŒ–æ ·å¼,è®©ç•Œé¢æ›´ç´§å‡‘ */
.inspiration-wrapper {
width: 100%;
max-width: 700px; /* å‡å°æœ€å¤§å®½åº¦ */
margin: 0 auto;
padding: 0.5rem; /* å‡å°å†…è¾¹è· */
}
/* å¤´éƒ¨æœç´¢å’ŒæŒ‰é’®åŒºåŸŸ */
.inspiration-header {
margin-bottom: 0.5rem;
padding: 0.5rem;
}
/* æ ‡ç­¾ç­›é€‰åŒºåŸŸ */
.inspiration-filters {
padding: 0.25rem 0.5rem;
margin-bottom: 0.5rem;
}
/* çµæ„Ÿåˆ—è¡¨å¸ƒå±€ */
.inspiration-grid {
gap: 0.25rem; /* è¿›ä¸€æ­¥å‡å°é—´è· */
padding: 0.25rem 0;
}
/* çµæ„Ÿå¡ç‰‡æ ·å¼ */
.inspiration-item {
padding: 0.35rem; /* å‡å°å†…è¾¹è· */
}
/* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
.btn-sm {
padding: 0.2rem 0.4rem;
font-size: 0.8rem;
}
/* æœç´¢æ¡†æ ·å¼ */
.inspiration-search input {
padding: 0.25rem 0.5rem 0.25rem 1.75rem;
font-size: 0.85rem;
}
/* æ ‡ç­¾æ ·å¼ */
.tag-btn {
padding: 0.15rem 0.35rem;
font-size: 0.8rem;
}
/* æ·»åŠ å¤é€‰æ¡†æ ·å¼ */
.inspiration-checkbox {
display: flex;
align-items: center;
margin-right: 0.25rem;
}
.inspiration-select {
width: 16px;
height: 16px;
cursor: pointer;
}
/* æ‹–æ‹½æ ·å¼ */
.inspiration-item.dragging {
opacity: 0.5;
background: #f8f9fa;
}
/* è°ƒæ•´å¸ƒå±€ä»¥é€‚åº”å¤é€‰æ¡† */
.inspiration-header-row {
display: flex;
align-items: flex-start;
gap: 0.25rem;
}
.todo-item.dragging {
opacity: 0.5;
background: #f8f9fa;
}
.todo-item.drag-over-top {
border-top: 2px solid #3498db;
}
.todo-item.drag-over-bottom {
border-bottom: 2px solid #3498db;
}
.todo-list {
min-height: 50px;
padding: 8px;
}
.todo-item {
cursor: move;
transition: all 0.2s ease;
}
.total-saved-container {
background: linear-gradient(145deg, #f8f9fa, #ffffff);
border-radius: 10px;
padding: 1rem;
margin-top: 1.5rem;
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
text-align: center;
}
.total-saved-label {
color: #6c757d;
font-size: 0.9rem;
margin-bottom: 0.5rem;
}
.total-saved-amount {
color: #2ecc71;
font-size: 1.5rem;
font-weight: 600;
margin: 0;
}
.timeline-view {
padding: 20px;
}
.timeline-group {
margin-bottom: 2rem;
border-radius: 8px;
background: #fff;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.timeline-date {
padding: 10px 15px;
background: #f8f9fa;
border-radius: 8px 8px 0 0;
color: #495057;
font-weight: 500;
font-size: 0.9rem;
}
.timeline-items {
padding: 15px;
}
.timeline-item {
position: relative;
padding-left: 24px;
margin-bottom: 15px;
}
.timeline-item:last-child {
margin-bottom: 0;
}
.timeline-item::before {
content: '';
position: absolute;
left: 0;
top: 8px;
width: 8px;
height: 8px;
border-radius: 50%;
background: #6c757d;
}
.timeline-item::after {
content: '';
position: absolute;
left: 3px;
top: 16px;
width: 2px;
height: calc(100% + 7px);
background: #e9ecef;
}
.timeline-item:last-child::after {
display: none;
}
.view-switch {
display: flex;
gap: 0.5rem;
margin-bottom: 1rem;
}
.view-switch button {
padding: 0.25rem 0.75rem;
border: 1px solid #dee2e6;
border-radius: 4px;
background: #fff;
color: #495057;
cursor: pointer;
transition: all 0.2s;
}
.view-switch button.active {
background: #0d6efd;
color: #fff;
border-color: #0d6efd;
}
/* ä¼˜åŒ–çµæ„Ÿç•Œé¢æŒ‰é’®æ ·å¼ */
.inspiration-actions-group {
display: flex;
gap: 0.5rem;
align-items: center;
}
.inspiration-actions-group .btn {
display: inline-flex;
align-items: center;
gap: 0.35rem;
padding: 0.4rem 0.8rem;
font-size: 0.875rem;
border-radius: 6px;
transition: all 0.2s ease;
box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.inspiration-actions-group .btn:hover {
transform: translateY(-1px);
box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.inspiration-actions-group .btn i {
font-size: 0.875rem;
}
.inspiration-actions-group .btn-primary {
background: linear-gradient(145deg, #0d6efd, #0b5ed7);
border: none;
}
.inspiration-actions-group .btn-success {
background: linear-gradient(145deg, #198754, #157347);
border: none;
}
.inspiration-actions-group .btn-danger {
background: linear-gradient(145deg, #dc3545, #bb2d3b);
border: none;
}
.inspiration-actions-group .btn-secondary {
background: linear-gradient(145deg, #6c757d, #5c636a);
border: none;
}
.inspiration-header {
background: #fff;
padding: 1rem;
border-radius: 8px;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
margin-bottom: 1rem;
}
.inspiration-search {
position: relative;
flex: 1;
max-width: 300px;
margin-right: 1rem;
}
.inspiration-search input {
width: 100%;
padding: 0.5rem 1rem 0.5rem 2.2rem;
border: 1px solid #dee2e6;
border-radius: 6px;
font-size: 0.875rem;
transition: all 0.2s;
}
.inspiration-search input:focus {
outline: none;
border-color: #86b7fe;
box-shadow: 0 0 0 0.25rem rgba(13,110,253,.25);
}
.inspiration-search i {
position: absolute;
left: 0.75rem;
top: 50%;
transform: translateY(-50%);
color: #6c757d;
font-size: 0.875rem;
}
.view-switch {
margin: 0 1rem;
}
.view-switch button {
padding: 0.4rem 0.8rem;
font-size: 0.875rem;
border-radius: 6px;
}
.view-switch button i {
margin-right: 0.35rem;
}
.view-switch button:hover {
transform: translateY(-1px);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
/* è°ƒæ•´å¡ç‰‡é—´è·å’Œå†…éƒ¨å¸ƒå±€ */
.card {
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
/* æ—¶é—´ç»Ÿè®¡ç•Œé¢æ ·å¼ */
.time-tracking-container {
padding: 20px;
background: #fff;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.event-card {
background: #f8f9fa;
border-radius: 8px;
padding: 15px;
margin-bottom: 15px;
box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.event-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 10px;
}
.event-name {
font-weight: 500;
color: #333;
}
.time-input {
width: 120px;
padding: 4px 8px;
border: 1px solid #ddd;
border-radius: 4px;
margin-right: 8px;
}
.time-total {
color: #666;
font-size: 14px;
margin-top: 8px;
}
.add-event-btn {
margin-bottom: 20px;
padding: 8px 16px;
background-color: #007bff;
color: white;
border: none;
border-radius: 4px;
cursor: pointer;
}
.add-event-btn:hover {
background-color: #0056b3;
}
.event-card .btn {
padding: 4px 12px;
font-size: 14px;
margin-left: 8px;
}
.event-card .btn-success {
background-color: #28a745;
border-color: #28a745;
color: white;
}
.event-card .btn-danger {
background-color: #dc3545;
border-color: #dc3545;
color: white;
}
/* å“åº”å¼å¸ƒå±€ä¼˜åŒ– */
@media (max-width: 576px) {
.event-header {
flex-direction: column;
align-items: flex-start;
}
.event-name {
margin-bottom: 10px;
}
.time-input {
width: 100%;
margin-bottom: 10px;
}
.event-card .btn {
margin-left: 0;
margin-right: 8px;
}
}
/* å¯¼èˆªæŒ‰é’®ç»„æ ·å¼ */
.btn-group {
display: flex;
flex-wrap: wrap;
gap: 0.25rem;
}
.btn-group .btn {
border-radius: 4px !important;
margin: 0 !important;
white-space: nowrap;
}
.btn-group .btn-outline-primary {
padding: 0.25rem 0.75rem;
font-size: 0.875rem;
}
.btn-group .btn-check:checked + .btn-outline-primary {
background-color: #0d6efd;
color: white;
}
@media (max-width: 768px) {
.btn-group {
flex-wrap: wrap;
justify-content: flex-start;
width: 100%;
}
}
/* å¯¼èˆªæŒ‰é’®æ ·å¼ */
.nav-buttons {
display: flex;
flex-wrap: wrap;
gap: 0.25rem;
}
.nav-buttons .btn {
padding: 0.25rem 0.75rem;
font-size: 0.875rem;
border-radius: 4px;
margin: 0;
white-space: nowrap;
}
.nav-buttons .btn-check:checked + .btn-outline-primary {
background-color: #0d6efd;
color: white;
}
@media (max-width: 768px) {
.nav-buttons {
width: 100%;
justify-content: flex-start;
}
}
/* è§†å›¾å®¹å™¨æ ·å¼ */
.view-container {
display: none;
width: 100%;
margin-top: 1rem;
}
.view-container.active {
display: block;
}
/* å¯¼èˆªæŒ‰é’®æ ·å¼ */
.nav-buttons {
display: flex;
flex-wrap: wrap;
gap: 0.25rem;
margin-top: 0.5rem;
}
.nav-buttons .btn {
padding: 0.25rem 0.75rem;
font-size: 0.875rem;
border-radius: 4px;
margin: 0;
white-space: nowrap;
}
.nav-buttons .btn-check:checked + .btn-outline-primary {
background-color: #0d6efd;
color: white;
}
/* æ—¶é—´ç»Ÿè®¡ç•Œé¢æ ·å¼ */
.time-tracking-container {
background: #fff;
border-radius: 10px;
padding: 1.5rem;
margin-top: 1rem;
}
.event-card {
background: #f8f9fa;
border-radius: 8px;
padding: 1rem;
margin-bottom: 1rem;
box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.event-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 0.5rem;
}
.event-name {
font-weight: 500;
color: #2c3e50;
}
.time-input {
width: 120px;
padding: 0.25rem 0.5rem;
border: 1px solid #ced4da;
border-radius: 4px;
margin-right: 0.5rem;
}
.time-total {
color: #6c757d;
font-size: 0.9rem;
margin-top: 0.25rem;
}
.add-event-btn {
margin-bottom: 1rem;
}
/* å¯¼èˆªæŒ‰é’®ç»„æ ·å¼ */
.btn-group {
display: flex;
flex-wrap: wrap;
gap: 4px;
margin-left: 1rem;
}
.btn-group .btn {
border-radius: 4px !important;
margin: 0 !important;
white-space: nowrap;
font-size: 0.875rem;
padding: 0.25rem 0.75rem;
}
.btn-group .btn-check:checked + .btn-outline-primary {
background-color: #0d6efd;
color: white;
}
@media (max-width: 768px) {
.btn-group {
margin-left: 0;
margin-top: 0.5rem;
width: 100%;
}
.btn-group .btn {
flex: 1;
text-align: center;
padding: 0.375rem 0.5rem;
}
}
/* å¡ç‰‡å¤´éƒ¨å¸ƒå±€ */
.card-header .d-flex {
gap: 0.5rem;
}
.card-title {
white-space: nowrap;
margin-bottom: 0 !important;
}
/* å¯¼èˆªæŒ‰é’®ç»„æ ·å¼ä¼˜åŒ– */
.btn-group {
gap: 0.25rem;
}
.btn-group .btn {
font-size: 0.875rem !important;
padding: 0.25rem 0.75rem !important;
border-radius: 4px !important;
margin: 0.125rem !important;
}
.btn-group .btn-outline-primary:hover {
background-color: #0d6efd;
color: white;
}
.btn-group .btn-check:checked + .btn-outline-primary {
background-color: #0d6efd;
color: white;
box-shadow: 0 2px 4px rgba(13, 110, 253, 0.2);
}
@media (max-width: 768px) {
.btn-group {
width: 100%;
justify-content: flex-start;
}
.btn-group .btn {
flex: 1 1 auto;
min-width: calc(33.333% - 0.5rem);
text-align: center;
}
}
/* ä¸ªäººæ•°æ®ç•Œé¢æ ·å¼ */
.personal-data-container {
padding: 1rem;
}
.data-category {
transition: all 0.3s ease;
border: none;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.data-category:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
.data-category .card-header {
background: linear-gradient(145deg, #f8f9fa, #ffffff);
border-bottom: 1px solid rgba(0,0,0,0.05);
}
.data-item {
padding: 0.5rem;
border-radius: 4px;
background: #f8f9fa;
margin-bottom: 0.5rem;
transition: all 0.2s ease;
}
.data-item:hover {
background: #e9ecef;
}
.data-content {
font-size: 0.9rem;
color: #495057;
}
.data-item .badge {
font-size: 0.8rem;
padding: 0.25rem 0.5rem;
}
.data-item .btn-group {
opacity: 0.6;
transition: opacity 0.2s ease;
}
.data-item:hover .btn-group {
opacity: 1;
}
.categories-container {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
gap: 1rem;
padding: 1rem 0;
}
@media (max-width: 768px) {
.categories-container {
grid-template-columns: 1fr;
}
.data-item .btn-group {
opacity: 1;
}
}
/* æ·»åŠ æŒ‰é’®æ‚¬åœæ•ˆæœ */
.personal-data-container .btn {
transition: all 0.2s ease;
}
.personal-data-container .btn:hover {
transform: translateY(-1px);
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
/* æ•°æ®é¡¹åŠ¨ç”»æ•ˆæœ */
.data-item {
animation: fadeIn 0.3s ease;
}
@keyframes fadeIn {
from {
opacity: 0;
transform: translateY(10px);
}
to {
opacity: 1;
transform: translateY(0);
}
}
</style>
</head>
<body>
<div class="container mt-4">
<div class="row">
<div class="col-md-3">
<div class="card mb-4">
<div class="card-header">
<h5 class="card-title">è®¾ç½®</h5>
</div>
<div class="card-body">
<form class="mb-3" id="birthDateForm">
<div class="mb-3">
<label class="form-label">å‡ºç”Ÿæ—¥æœŸ (YYYYMMDD):</label>
<input class="form-control" id="birthDate" type="text"/>
</div>
<button class="btn btn-primary w-100" type="submit">è®¾ç½®å‡ºç”Ÿæ—¥æœŸ</button>
</form>
<button class="btn btn-primary w-100 mb-3" onclick="showAgeSettingsModal()">æ·»åŠ æ—¶é—´è¿›åº¦</button>
<form id="goalForm">
<div class="mb-3">
<label class="form-label">å­˜æ¬¾å†…å®¹:</label>
<input class="form-control" id="goalName" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">ç›®æ ‡é‡‘é¢:</label>
<input class="form-control" id="goalAmount" type="text"/>
</div>
<button class="btn btn-primary w-100" type="submit">æ·»åŠ å­˜æ¬¾è¿›åº¦</button>
</form>
<div class="card mt-2">
<div class="card-header py-2">è®°å½•å­˜å–æ¬¾</div>
<div class="card-body p-2">
<form id="moneyForm">
<div class="mb-2">
<div class="btn-group w-100" role="group">
<input class="btn-check" id="depositType" name="operationType" type="radio" value="deposit"/>
<label class="btn btn-outline-success" for="depositType">å­˜å…¥</label>
<input class="btn-check" id="withdrawType" name="operationType" type="radio" value="withdraw"/>
<label class="btn btn-outline-warning" for="withdrawType">å–å‡º</label>
</div>
</div>
<div class="mb-2">
<label class="form-label mb-1">é‡‘é¢:</label>
<input class="form-control form-control-sm" id="amount" type="text"/>
</div>
<div class="mb-2">
<label class="form-label mb-1">å¤‡æ³¨:</label>
<input class="form-control form-control-sm" id="note" placeholder="å¯é€‰" type="text"/>
</div>
<button class="btn btn-primary btn-sm w-100" type="submit">ç¡®è®¤</button>
</form>
</div>
</div>
<div class="text-center mt-4">
<div>æ€»å­˜æ¬¾</div>
<div class="text-success fs-4 fw-bold" id="totalSaved">${formatMoney(appData.totalSaved)}</div>
<div class="text-muted mt-2">
<div id="currentDate"></div>
<div id="currentTime"></div>
</div>
</div>
</div>
</div>
</div>
<div class="col-md-9">
<div class="card">
<div class="card-header">
<div class="d-flex flex-column flex-md-row align-items-start align-items-md-center">
<h5 class="card-title mb-2 mb-md-0 me-md-3">ç«æ˜Ÿè¿›åº¦</h5>
<div class="btn-group flex-wrap" role="group">
<input class="btn-check" id="savingsMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="savingsMode">å­˜æ¬¾è¿›åº¦</label>
<input class="btn-check" id="ageMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="ageMode">æ—¶é—´è¿›åº¦</label>
<input class="btn-check" id="historyMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="historyMode">å†å²è®°å½•</label>
<input class="btn-check" id="archiveMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="archiveMode">å½’æ¡£è®°å½•</label>
<input class="btn-check" id="todoMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="todoMode">å¾…åŠäº‹é¡¹</label>
<input class="btn-check" id="inspirationMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="inspirationMode">çµæ„Ÿè®°å½•</label>
<input class="btn-check" id="habitMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="habitMode">ä¹ æƒ¯æ‰“å¡</label>
<input class="btn-check" id="timeTrackingMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="timeTrackingMode">æ—¶é—´ç»Ÿè®¡</label>
<input class="btn-check" id="personalDataMode" name="viewMode" type="radio"/>
<label class="btn btn-outline-primary" for="personalDataMode">ä¸ªäººæ•°æ®</label>
</div>
</div>
<div class="d-flex flex-wrap align-items-center gap-2">
<!-- å¯¼å…¥å¯¼å‡ºæŒ‰é’®ç»„ -->
<div class="d-flex gap-2">
<button class="btn btn-primary btn-sm py-1 px-3" onclick="exportData()" style="min-width: 80px;">å¯¼å‡ºæ•°æ®</button>
<button class="btn btn-success btn-sm py-1 px-3" onclick="document.getElementById('importFile').click()" style="min-width: 80px;">å¯¼å…¥æ•°æ®</button>
<input accept=".json" id="importFile" onchange="importData(event)" style="display: none" type="file"/>
</div>
<!-- å³ä¾§åŠŸèƒ½æŒ‰é’®ç»„ï¼Œä½¿ç”¨ ms-auto å°†å…¶æ¨åˆ°æœ€å³è¾¹ -->
<div class="d-flex gap-2 ms-auto">
<!-- æ¸…ç©ºæŒ‰é’® -->
<button class="btn btn-warning btn-sm py-1 px-3" onclick="clearHistory()" style="min-width: 80px;">æ¸…ç©ºå†å²</button>
<button class="btn btn-warning btn-sm py-1 px-3" onclick="clearArchived()" style="min-width: 80px;">æ¸…ç©ºå½’æ¡£</button>
<!-- é‡ç½®æŒ‰é’® -->
<button class="btn btn-danger btn-sm py-1 px-3" onclick="resetSavings()" style="min-width: 80px;">é‡ç½®å­˜æ¬¾</button>
<button class="btn btn-danger btn-sm py-1 px-3" onclick="resetTime()" style="min-width: 80px;">é‡ç½®æ—¶é—´</button>
</div>
</div>
</div>
<div class="card-body">
<div class="goal-container" id="goalsContainer">
<!-- Goals will be added here dynamically -->
</div>
<!-- æ·»åŠ æ—¶é—´ç»Ÿè®¡ç•Œé¢ -->
<div class="time-tracking-container view-container" style="display: none;">
<h3 class="mb-3">æ—¶é—´ç»Ÿè®¡</h3>
<button class="btn btn-primary add-event-btn" onclick="addNewEvent()">
<i class="fas fa-plus"></i> æ·»åŠ æ–°äº‹ä»¶
                            </button>
<div id="events-container">
<!-- äº‹ä»¶å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- åœ¨ </body> æ ‡ç­¾å‰æ·»åŠ ä»¥ä¸‹ Bootstrap ç›¸å…³çš„ CDN å¼•ç”¨ -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
<script>
        // å°†å…³é”®é…ç½®é›†ä¸­ç®¡ç†ï¼Œä¾¿äºåæœŸä¿®æ”¹
        const CONFIG = {
            STORAGE_KEY: 'savingsData',
            CURRENT_DATE: new Date()
        };

        // æ•°æ®ç»“æ„
        let appData = {
            totalSaved: 0,
            goals: [],
            ageGoals: [],
            birthDate: null,
            history: [],  // æ·»åŠ å†å²è®°å½•æ•°ç»„
            archivedGoals: [],  // æ·»åŠ å½’æ¡£æ•°ç»„
            archivedAgeGoals: [], // æ·»åŠ å¹´é¾„ç›®æ ‡å½’æ¡£æ•°ç»„
            todos: {  // æ·»åŠ å››è±¡é™å¾…åŠäº‹é¡¹
                q1: [], // é‡è¦ä¸”ç´§æ€¥
                q2: [], // é‡è¦ä¸ç´§æ€¥
                q3: [], // ç´§æ€¥ä¸é‡è¦
                q4: []  // ä¸é‡è¦ä¸ç´§æ€¥
            },
            inspirations: [],
            inspirationTags: ['å·¥ä½œ', 'å­¦ä¹ ', 'ç”Ÿæ´»', 'å…¶ä»–'], // é»˜è®¤æ ‡ç­¾
            timeEvents: [] // æ·»åŠ æ—¶é—´ç»Ÿè®¡äº‹ä»¶æ•°ç»„
        };

        // å®šä¹‰ä¸€ä¸ªå®‰å…¨çš„é‡‘é¢å¤„ç†ç±»
        class SafeMoney {
            constructor(amount = 0) {
                this.value = Math.round(amount);
            }

            static fromYuan(yuan) {
                return new SafeMoney(yuan);
            }

            static fromValue(value) {
                const money = new SafeMoney(0);
                money.value = Math.round(value);
                return money;
            }

            add(other) {
                if (other instanceof SafeMoney) {
                    return SafeMoney.fromValue(this.value + other.value);
                }
                return SafeMoney.fromValue(this.value + Math.round(other));
            }

            subtract(other) {
                if (other instanceof SafeMoney) {
                    return SafeMoney.fromValue(this.value - other.value);
                }
                return SafeMoney.fromValue(this.value - Math.round(other));
            }

            toYuan() {
                return this.value;
            }

            toString() {
                return this.value.toString();
            }
        }

        // ä¿®æ”¹è§£æé‡‘é¢çš„å‡½æ•°
        function parseAmount(input) {
            try {
                let amount = 0;
                const units = {
                    'ä¸‡': 10000,
                    'w': 10000,
                    'åä¸‡': 100000,
                    'sw': 100000,
                    'ç™¾ä¸‡': 1000000,
                    'bw': 1000000
                };
                
                for (const [unit, multiplier] of Object.entries(units)) {
                    if (input.includes(unit)) {
                        const numPart = input.split(unit)[0] || '1';
                        if (!isNaN(numPart)) {
                            amount = Math.round(parseFloat(numPart) * multiplier);
                            break;
                        }
                    }
                }
                
                if (amount === 0) {
                    if (!isNaN(input)) {
                        amount = Math.round(parseFloat(input));
                    } else {
                        throw new Error('æ— æ•ˆçš„é‡‘é¢æ ¼å¼');
                    }
                }
                
                if (isNaN(amount) || amount <= 0) {
                    throw new Error('é‡‘é¢å¿…é¡»å¤§äº0');
                }
                
                return amount;
            } catch (error) {
                throw new Error('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡‘é¢ï¼ˆå¦‚ï¼š100ã€1ä¸‡ã€50wã€100ä¸‡ï¼‰');
            }
        }

        // UI æ›´æ–°å‡½æ•°
        function renderViewMode(view) {
            const totalElement = document.getElementById('totalSaved');
            if (totalElement) {
                totalElement.textContent = formatMoney(appData.totalSaved);
            }

            const container = document.getElementById('goalsContainer');
            if (!container) return;

            // æ›´æ–°è§†å›¾é€‰æ‹©çŠ¶æ€
            if (view) {
                const viewModes = {
                    'savings': 'savingsMode',
                    'age': 'ageMode',
                    'history': 'historyMode',
                    'archive': 'archiveMode',
                    'todo': 'todoMode',
                    'inspiration': 'inspirationMode',
                    'habit': 'habitMode',
                    'timeTracking': 'timeTrackingMode',
                    'personalData': 'personalDataMode'
                };

                // é‡ç½®æ‰€æœ‰æŒ‰é’®çŠ¶æ€
                Object.values(viewModes).forEach(modeId => {
                    const element = document.getElementById(modeId);
                    if (element) {
                        element.checked = false;
                    }
                });

                // è®¾ç½®å½“å‰è§†å›¾æŒ‰é’®çŠ¶æ€
                const currentModeId = viewModes[view];
                if (currentModeId) {
                    const element = document.getElementById(currentModeId);
                    if (element) {
                        element.checked = true;
                    }
                }
            }

            // æ ¹æ®å½“å‰è§†å›¾æ˜¾ç¤ºç›¸åº”å†…å®¹
            if (view === 'timeTracking' || document.getElementById('timeTrackingMode').checked) {
                showTimeTrackingView();
                return;
            }

            // æ˜¾ç¤ºç›®æ ‡å®¹å™¨
            container.style.display = 'grid';
            container.className = 'goal-container';
            container.innerHTML = '';

            // æ ¹æ®è§†å›¾ç±»å‹æ˜¾ç¤ºå†…å®¹
            if (document.getElementById('inspirationMode').checked) {
                container.className = 'inspiration-wrapper';
                displayInspirations(container);
            } else if (document.getElementById('todoMode').checked) {
                displayTodos(container);
            } else if (document.getElementById('archiveMode').checked) {
                displayArchived(container);
            } else if (document.getElementById('historyMode').checked) {
                displayHistory(container);
            } else if (document.getElementById('ageMode').checked) {
                displayAgeGoals(container);
            } else if (document.getElementById('habitMode').checked) {
                showHabitView();
            } else if (document.getElementById('personalDataMode').checked) {
                displayPersonalData(container);
            } else {
                displaySavingsGoals(container);
            }

            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // äº‹ä»¶å¤„ç†å‡½æ•°
        document.getElementById('goalForm').addEventListener('submit', (e) => {
            e.preventDefault();
            try {
                const name = document.getElementById('goalName').value;
                const amountStr = document.getElementById('goalAmount').value;
                const amount = parseAmount(amountStr);
                
                // ç¡®ä¿ appData.goals æ˜¯æ•°ç»„
                if (!Array.isArray(appData.goals)) {
                    appData.goals = [];
                }
                
                // æ·»åŠ æ–°ç›®æ ‡
                appData.goals.push({
                    name: name,
                    target: amount
                });
                
                // æŒ‰ç›®æ ‡é‡‘é¢ä»å°åˆ°å¤§æ’åº
                appData.goals.sort((a, b) => a.target - b.target);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                document.getElementById('goalName').value = '';
                document.getElementById('goalAmount').value = '';
                
                renderViewMode();
            } catch (error) {
                alert(error.message);
            }
        });

        document.getElementById('moneyForm').addEventListener('submit', (e) => {
            e.preventDefault();
            try {
                const amountStr = document.getElementById('amount').value;
                const note = document.getElementById('note').value;
                const amount = parseAmount(amountStr);
                const operationType = document.querySelector('input[name="operationType"]:checked').value;
                
                const currentMoney = SafeMoney.fromYuan(appData.totalSaved);
                const money = SafeMoney.fromYuan(amount);
                
                let newTotal;
                if (operationType === 'deposit') {
                    newTotal = currentMoney.add(money);
                } else {
                    if (amount > appData.totalSaved) {
                    throw new Error('å–æ¬¾é‡‘é¢ä¸èƒ½å¤§äºæ€»å­˜æ¬¾');
                    }
                    newTotal = currentMoney.subtract(money);
                }
                
                appData.totalSaved = newTotal.toYuan();
                addHistory(operationType, amount, note);
                
                document.getElementById('amount').value = '';
                document.getElementById('note').value = '';
                // ä¿æŒåœ¨å½“å‰è§†å›¾æ›´æ–°UI
                const isAgeMode = document.getElementById('ageMode').checked;
                const isHistoryMode = document.getElementById('historyMode').checked;
                renderViewMode(isAgeMode ? 'age' : (isHistoryMode ? 'history' : 'savings'));
            } catch (error) {
                alert(error.message);
            }
        });

        function deleteGoal(index) {
            appData.goals.splice(index, 1);
            renderViewMode();
        }

        // åˆå§‹åŒ–
        function initialize() {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
            const savedData = localStorage.getItem(CONFIG.STORAGE_KEY);
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    appData = {
                        ...appData,  // ä¿æŒé»˜è®¤å€¼
                        ...parsedData,  // åŠ è½½ä¿å­˜çš„æ•°æ®
                        timeEvents: Array.isArray(parsedData.timeEvents) ? parsedData.timeEvents : []  // ç¡®ä¿timeEventsæ˜¯æ•°ç»„
                    };
                } catch (e) {
                    console.error('Error parsing saved data:', e);
                    // å¦‚æœè§£æå¤±è´¥ï¼Œç¡®ä¿timeEventsè¢«åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„
                    appData.timeEvents = [];
                }
            }

            // åˆå§‹åŒ–è§†å›¾æ¨¡å¼
            const viewModes = {
                'savings': 'savingsMode',
                'age': 'ageMode',
                'history': 'historyMode',
                'archive': 'archiveMode',
                'todo': 'todoMode',
                'inspiration': 'inspirationMode',
                'habit': 'habitMode',
                'timeTracking': 'timeTrackingMode',
                'personalData': 'personalDataMode'
            };

            // ä¸ºæ¯ä¸ªè§†å›¾æ¨¡å¼æ·»åŠ äº‹ä»¶ç›‘å¬
            Object.entries(viewModes).forEach(([modeId, viewName]) => {
                const element = document.getElementById(modeId);
                if (element) {
                    element.addEventListener('change', () => {
                        if (element.checked) {
                            renderViewMode(viewName);
                        }
                    });
                }
            });

            // æ›´æ–°UI
            renderViewMode();
            updateDateTime();
            setInterval(updateDateTime, 1000);
        }

        // ç¡®ä¿åœ¨é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            const savingsMode = document.getElementById('savingsMode');
            const ageMode = document.getElementById('ageMode');
            const historyMode = document.getElementById('historyMode');
            const archiveMode = document.getElementById('archiveMode');
            const todoMode = document.getElementById('todoMode');
            const inspirationMode = document.getElementById('inspirationMode');
            const habitMode = document.getElementById('habitMode');
            const timeTrackingMode = document.getElementById('timeTrackingMode');
            const personalDataMode = document.getElementById('personalDataMode');
            
            if (savingsMode && ageMode && historyMode && archiveMode && todoMode && inspirationMode && habitMode && timeTrackingMode && personalDataMode) {
                savingsMode.addEventListener('change', () => {
                    if (savingsMode.checked) renderViewMode('savings');
                });
                
                ageMode.addEventListener('change', () => {
                    if (ageMode.checked) renderViewMode('age');
                });
                
                historyMode.addEventListener('change', () => {
                    if (historyMode.checked) renderViewMode('history');
                });
                
                archiveMode.addEventListener('change', () => {
                    if (archiveMode.checked) renderViewMode('archive');
                });
                
                todoMode.addEventListener('change', () => {
                    if (todoMode.checked) renderViewMode('todo');
                });
                
                inspirationMode.addEventListener('change', () => {
                    if (inspirationMode.checked) renderViewMode('inspiration');
                });
                
                habitMode.addEventListener('change', () => {
                    if (habitMode.checked) renderViewMode('habit');
                });
                timeTrackingMode.addEventListener('change', () => {
                    if (timeTrackingMode.checked) renderViewMode('timeTracking');
                });
                personalDataMode.addEventListener('change', () => {
                    if (personalDataMode.checked) renderViewMode('personalData');
                });
            }
            
            initialize();
        });

        // å¯¼å‡ºæ•°æ®å‡½æ•°
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `savings-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // å¯¼å…¥æ•°æ®å‡½æ•°
        function importData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const imported = JSON.parse(e.target.result);
                        if (confirm('ç¡®å®šè¦å¯¼å…¥æ•°æ®å—ï¼Ÿå½“å‰æ•°æ®å°†è¢«æ›¿æ¢ã€‚')) {
                            appData = {
                                totalSaved: Number((Math.round(parseFloat(imported.totalSaved || 0) * 100) / 100).toFixed(2)),
                                goals: Array.isArray(imported.goals) ? imported.goals.map(goal => ({
                                    name: goal.name,
                                    target: Number((Math.round(parseFloat(goal.target) * 100) / 100).toFixed(2))
                                })) : [],
                                ageGoals: Array.isArray(imported.ageGoals) ? imported.ageGoals : [],
                                birthDate: imported.birthDate,
                                history: imported.history || [],
                                archivedGoals: Array.isArray(imported.archivedGoals) ? imported.archivedGoals : [],
                                archivedAgeGoals: Array.isArray(imported.archivedAgeGoals) ? imported.archivedAgeGoals : [],
                                todos: imported.todos || { q1: [], q2: [], q3: [], q4: [] },
                                inspirations: Array.isArray(imported.inspirations) ? imported.inspirations : [],
                                inspirationTags: imported.inspirationTags || ['å·¥ä½œ', 'å­¦ä¹ ', 'ç”Ÿæ´»', 'å…¶ä»–'],
                                timeEvents: Array.isArray(imported.timeEvents) ? imported.timeEvents : [],
                                habits: Array.isArray(imported.habits) ? imported.habits : [],
                                personalData: imported.personalData || { categories: [] }
                            };
                            renderViewMode();
                            alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                        }
                    } catch (error) {
                        alert('å¯¼å…¥å¤±è´¥ï¼šæ— æ•ˆçš„æ•°æ®æ ¼å¼');
                    }
                };
                reader.readAsText(file);
            }
            event.target.value = '';
        }

        // æ·»åŠ æ—¥æœŸè®¡ç®—çš„è¾…åŠ©å‡½æ•°
        function calculateDaysBetweenDates(startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            start.setHours(0, 0, 0, 0);
            end.setHours(0, 0, 0, 0);
            const diffTime = end - start;
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        // ä¿®æ”¹æ—¥æœŸæ ¼å¼åŒ–å‡½æ•°
        function formatDateToYYYYMMDD(date) {
            const d = new Date(date);
            return d.getFullYear().toString() +
                   (d.getMonth() + 1).toString().padStart(2, '0') +
                   d.getDate().toString().padStart(2, '0');
        }

        function parseDateString(dateStr) {
            if (!dateStr || !/^\d{8}$/.test(dateStr)) {
                return new Date();
            }
            const year = parseInt(dateStr.substring(0, 4));
            const month = parseInt(dateStr.substring(4, 6)) - 1;
            const day = parseInt(dateStr.substring(6, 8));
            return new Date(year, month, day);
        }

        // ä¿®æ”¹æ˜¾ç¤ºå¹´é¾„ç›®æ ‡çš„å‡½æ•°
        function displayAgeGoals(container) {
            container.innerHTML = '';
            
            if (!appData.birthDate) {
                container.innerHTML = '<div class="alert alert-warning">è¯·å…ˆè®¾ç½®å‡ºç”Ÿæ—¥æœŸ</div>';
                return;
            }

            if (!appData.ageGoals || appData.ageGoals.length === 0) {
                container.innerHTML = '<div class="alert alert-info">æš‚æ— æ—¶é—´ç›®æ ‡ï¼Œè¯·ç‚¹å‡»"æ·»åŠ æ—¶é—´ç›®æ ‡"æŒ‰é’®æ·»åŠ </div>';
                return;
            }

            const BIRTH_DATE = parseDateString(appData.birthDate);
            const CURRENT_DATE = new Date();

            const yearlyGoals = [];
            const lifetimeGoals = [];
            
            appData.ageGoals.forEach(goal => {
                if (!goal.category) {
                    goal.category = 'yearly';
                }
                if (goal.category === 'yearly') {
                    yearlyGoals.push(goal);
                } else {
                    lifetimeGoals.push(goal);
                }
            });

            const sortByTargetDate = (a, b) => {
                const dateA = parseDateString(a.targetDate);
                const dateB = parseDateString(b.targetDate);
                return dateA - dateB;
            };

            yearlyGoals.sort(sortByTargetDate);
            lifetimeGoals.sort(sortByTargetDate);

            if (yearlyGoals.length > 0) {
                const yearlySection = document.createElement('div');
                yearlySection.className = 'age-goals-section';
                
                const yearlyTitle = document.createElement('h6');
                yearlyTitle.className = 'age-category-title yearly';
                yearlyTitle.textContent = 'ä»Šå¹´è¿›åº¦';
                yearlySection.appendChild(yearlyTitle);

                const yearlyGrid = document.createElement('div');
                yearlyGrid.className = 'age-goals-grid';
                yearlyGoals.forEach(goal => {
                    const realIndex = appData.ageGoals.indexOf(goal);
                    const card = createGoalCard(goal, realIndex);
                    card.classList.add('yearly');
                    yearlyGrid.appendChild(card);
                });
                yearlySection.appendChild(yearlyGrid);
                container.appendChild(yearlySection);
            }

            if (lifetimeGoals.length > 0) {
                const lifetimeSection = document.createElement('div');
                lifetimeSection.className = 'age-goals-section';
                
                const lifetimeTitle = document.createElement('h6');
                lifetimeTitle.className = 'age-category-title lifetime';
                lifetimeTitle.textContent = 'äººç”Ÿæ€»è¿›åº¦';
                lifetimeSection.appendChild(lifetimeTitle);

                const lifetimeGrid = document.createElement('div');
                lifetimeGrid.className = 'age-goals-grid';
                lifetimeGoals.forEach(goal => {
                    const realIndex = appData.ageGoals.indexOf(goal);
                    const card = createGoalCard(goal, realIndex);
                    card.classList.add('lifetime');
                    lifetimeGrid.appendChild(card);
                });
                lifetimeSection.appendChild(lifetimeGrid);
                container.appendChild(lifetimeSection);
            }

            function createGoalCard(goal, index) {
                const targetDate = parseDateString(goal.targetDate);
                
                const currentAgeInYears = (CURRENT_DATE - BIRTH_DATE) / (1000 * 60 * 60 * 24 * 365.25);
                const currentYears = Math.floor(currentAgeInYears);
                const currentMonths = Math.floor((currentAgeInYears - currentYears) * 12);
                
                const targetAgeInYears = (targetDate - BIRTH_DATE) / (1000 * 60 * 60 * 24 * 365.25);
                const targetYears = Math.floor(targetAgeInYears);
                const targetMonths = Math.floor((targetAgeInYears - targetYears) * 12);
                
                const remainingDays = calculateDaysBetweenDates(CURRENT_DATE, targetDate);

                let progress;
                if (goal.category === 'yearly') {
                    const yearStart = new Date(CURRENT_DATE.getFullYear(), 0, 1);
                    const daysFromStart = calculateDaysBetweenDates(yearStart, CURRENT_DATE);
                    const totalDaysUntilTarget = calculateDaysBetweenDates(yearStart, targetDate);
                    progress = (totalDaysUntilTarget > 0) ? (daysFromStart / totalDaysUntilTarget) * 100 : 100;
                } else {
                    const totalDays = calculateDaysBetweenDates(BIRTH_DATE, targetDate);
                    const daysPassed = calculateDaysBetweenDates(BIRTH_DATE, CURRENT_DATE);
                    progress = (totalDays > 0) ? (daysPassed / totalDays) * 100 : 100;
                }

                const timeStatus = progress >= 80 ? 'urgent' : progress >= 50 ? 'warning' : 'normal';

                const formatAge = (years, months) => {
                    if (months === 0) {
                        return `${years}å²`;
                    }
                    return `${years}å²${months}ä¸ªæœˆ`;
                };

                const card = document.createElement('div');
                card.className = 'card age-goal-card';
                card.innerHTML = `
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="goal-name">${goal.name}</div>
                            <div class="d-flex gap-2">
                                ${progress >= 100 ? `
                                    <button class="btn btn-success btn-sm py-0 px-2" onclick="archiveGoal(${index}, 'age')">
                                        <i class="fas fa-check-circle btn-icon"></i>å½’æ¡£
                                    </button>
                                ` : ''}
                                <button class="btn btn-primary btn-sm py-0 px-2" onclick="editAgeGoal(${index})">
                                    <i class="fas fa-edit btn-icon"></i>ç¼–è¾‘
                                </button>
                                <button class="btn btn-danger btn-sm py-0 px-2" onclick="deleteAgeGoal(${index})">
                                    <i class="fas fa-trash btn-icon"></i>åˆ é™¤
                                </button>
                            </div>
                        </div>
                        <div class="age-goal-info">
                            <div class="age-range">
                                <span>${formatAge(currentYears, currentMonths)}</span>
                                <span class="age-arrow">â†’</span>
                                <span>${formatAge(targetYears, targetMonths)}</span>
                            </div>
                            <div class="time-info">
                                <div class="remaining-days">
                                    <i class="fas fa-hourglass-half"></i>
                                    <span class="days-count">${remainingDays}</span>
                                    <span class="days-label">å¤©åæˆªæ­¢</span>
                                </div>
                                <div class="time-value ${timeStatus}">
                                    å·²è¿‡${Math.round(progress)}%æ—¶é—´
                                </div>
                            </div>
                            <div class="progress-section">
                                <div class="progress">
                                    <div class="progress-bar ${goal.category === 'lifetime' ? 'bg-warning' : ''}" 
                                         role="progressbar" 
                                         style="width: ${Math.min(100, Math.max(0, progress))}%"
                                         aria-valuenow="${progress}"
                                         aria-valuemin="0"
                                         aria-valuemax="100">
                                        ${progress.toFixed(1)}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                return card;
            }
        }

        // ä¿®æ”¹ä¿å­˜å¹´é¾„ç›®æ ‡çš„å‡½æ•°
        function saveAgeGoal() {
            const name = document.getElementById('ageGoalName').value;
            const targetDate = document.getElementById('targetDate').value;
            const category = document.getElementById('ageGoalCategory').value;

            if (!name || !targetDate || !category) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                return;
            }

            if (!/^\d{8}$/.test(targetDate)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ—¥æœŸæ ¼å¼ï¼ˆä¾‹å¦‚ï¼š20260106ï¼‰');
                return;
            }

            // ä¸ºç°æœ‰çš„ç›®æ ‡æ·»åŠ é»˜è®¤åˆ†ç±»
            if (!appData.ageGoals.every(goal => goal.hasOwnProperty('category'))) {
                appData.ageGoals = appData.ageGoals.map(goal => ({
                    ...goal,
                    category: 'yearly' // å°†ç°æœ‰ç›®æ ‡é»˜è®¤è®¾ç½®ä¸ºä»Šå¹´è¿›åº¦
                }));
            }

            // æ·»åŠ æ–°ç›®æ ‡
            appData.ageGoals.push({
                name: name,
                targetDate: targetDate,
                category: category
            });

            // æŒ‰æ—¥æœŸæ’åº
            appData.ageGoals.sort((a, b) => {
                const dateA = parseDateString(a.targetDate);
                const dateB = parseDateString(b.targetDate);
                return dateA - dateB;
            });

            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode();

            const modal = bootstrap.Modal.getInstance(document.getElementById('ageSettingsModal'));
            modal.hide();
        }

        // æ·»åŠ åˆ é™¤å¹´é¾„ç›®æ ‡çš„å‡½æ•°
        function deleteAgeGoal(index) {
            appData.ageGoals.splice(index, 1);
            renderViewMode();
        }

        // ä¿®æ”¹é‡ç½®å‡½æ•°,åˆ†ä¸ºé‡ç½®å­˜æ¬¾å’Œé‡ç½®å¹´é¾„
        function resetSavings() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰å­˜æ¬¾æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                appData.totalSaved = 0;
                appData.goals = [];
                renderViewMode();
            }
        }

        function resetTime() {
            appData.ageGoals = [];
            renderViewMode();
        }

        // ç¡®ä¿ showAgeSettingsModal å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸä¸­
        window.showAgeSettingsModal = showAgeSettingsModal;
        window.saveAgeGoal = saveAgeGoal;
        window.deleteAgeGoal = deleteAgeGoal;

        // ä¿®æ”¹æ·»åŠ å¹´é¾„ç›®æ ‡çš„æ¨¡æ€æ¡†
        function showAgeSettingsModal() {
            const content = `
                <form id="ageSettingsForm">
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡åˆ†ç±»</label>
                        <select class="form-select" id="ageGoalCategory" required>
                            <option value="yearly">ä»Šå¹´è¿›åº¦</option>
                            <option value="lifetime">äººç”Ÿæ€»è¿›åº¦</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡åç§°</label>
                        <input type="text" class="form-control" id="ageGoalName" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡æ—¥æœŸ (YYYYMMDDæ ¼å¼)</label>
                        <input type="text" class="form-control" id="targetDate" required>
                    </div>
                </form>
            `;

            const modalHtml = createModal({
                id: 'ageSettingsModal',
                title: 'æ·»åŠ æ—¶é—´ç›®æ ‡',
                content: content,
                onSave: 'saveAgeGoal()'
            });

            if (!document.getElementById('ageSettingsModal')) {
                document.body.insertAdjacentHTML('beforeend', modalHtml);
            } else {
                document.getElementById('ageSettingsModal').outerHTML = modalHtml;
            }

            const modal = new bootstrap.Modal(document.getElementById('ageSettingsModal'));
            modal.show();
        }

        // ç¡®ä¿æ·»åŠ æŒ‰é’®æ­£å¸¸å·¥ä½œ
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            document.body.addEventListener('click', function(e) {
                if (e.target.matches('.add-age-goal-btn') || e.target.closest('.add-age-goal-btn')) {
                    showAgeSettingsModal();
                }
            });
        });

        // æ·»åŠ  formatMoney å‡½æ•°
        function formatMoney(amount) {
            const value = Math.round(Number(amount));
            if (isNaN(value)) {
                return 'Â¥0';
            }
            return new Intl.NumberFormat('zh-CN', {
                style: 'currency',
                currency: 'CNY',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        }

        // ä¿®æ”¹å‡ºç”Ÿæ—¥æœŸè®¾ç½®å¤„ç†
        document.getElementById('birthDateForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const birthDateStr = document.getElementById('birthDate').value;
            
            if (!/^\d{8}$/.test(birthDateStr)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ—¥æœŸæ ¼å¼ï¼ˆä¾‹å¦‚ï¼š20000101ï¼‰');
                return;
            }
            
            try {
                const birthDate = parseDateString(birthDateStr);
                if (birthDate > new Date()) {
                    alert('å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šäºå½“å‰æ—¥æœŸ');
                    return;
                }
                
                appData.birthDate = birthDateStr;
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                document.getElementById('birthDate').value = '';
                
                renderViewMode();
                alert('å‡ºç”Ÿæ—¥æœŸè®¾ç½®æˆåŠŸï¼');
            } catch (error) {
                alert('æ—¥æœŸæ ¼å¼æ— æ•ˆï¼Œè¯·é‡è¯•');
            }
        });

        // æ·»åŠ ç¼–è¾‘å¹´é¾„ç›®æ ‡çš„å‡½æ•°
        function editAgeGoal(index) {
            const goal = appData.ageGoals[index];
            
            const content = `
                <form id="editAgeGoalForm">
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡åç§°</label>
                        <input type="text" class="form-control" id="editAgeGoalName" value="${goal.name}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡æ—¥æœŸ (YYYYMMDD)</label>
                        <input type="text" class="form-control" id="editTargetDate" value="${goal.targetDate}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ç›®æ ‡åˆ†ç±»</label>
                        <select class="form-select" id="editAgeGoalCategory">
                            <option value="yearly" ${goal.category === 'yearly' ? 'selected' : ''}>ä»Šå¹´è¿›åº¦</option>
                            <option value="lifetime" ${goal.category === 'lifetime' ? 'selected' : ''}>äººç”Ÿæ€»è¿›åº¦</option>
                        </select>
                    </div>
                    <input type="hidden" id="editGoalIndex" value="${index}">
                </form>
            `;

            const modalHtml = createModal({
                id: 'editAgeGoalModal',
                title: 'ç¼–è¾‘å¹´é¾„ç›®æ ‡',
                content: content,
                onSave: 'saveEditedAgeGoal()'
            });

            const existingModal = document.getElementById('editAgeGoalModal');
            if (existingModal) {
                existingModal.remove();
            }
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            const modal = new bootstrap.Modal(document.getElementById('editAgeGoalModal'));
            modal.show();
        }

        // æ·»åŠ ä¿å­˜ç¼–è¾‘åçš„å¹´é¾„ç›®æ ‡å‡½æ•°
        function saveEditedAgeGoal() {
            const index = parseInt(document.getElementById('editGoalIndex').value);
            const name = document.getElementById('editAgeGoalName').value;
            const targetDate = document.getElementById('editTargetDate').value;
            const category = document.getElementById('editAgeGoalCategory').value;

            if (!name || !targetDate || !category) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                return;
            }

            if (!/^\d{8}$/.test(targetDate)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ—¥æœŸæ ¼å¼ï¼ˆä¾‹å¦‚ï¼š20260106ï¼‰');
                return;
            }

            try {
                const date = parseDateString(targetDate);
                if (date < new Date()) {
                    alert('ç›®æ ‡æ—¥æœŸä¸èƒ½æ—©äºå½“å‰æ—¥æœŸ');
                    return;
                }

                appData.ageGoals[index] = {
                    name: name,
                    targetDate: targetDate,
                    category: category
                };

                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();

                const modal = bootstrap.Modal.getInstance(document.getElementById('editAgeGoalModal'));
                modal.hide();
            } catch (error) {
                alert('æ—¥æœŸæ ¼å¼æ— æ•ˆï¼Œè¯·é‡è¯•');
            }
        }

        // å°†ç¼–è¾‘å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.editAgeGoal = editAgeGoal;
        window.saveEditedAgeGoal = saveEditedAgeGoal;

        // æ·»åŠ ç¼–è¾‘å­˜æ¬¾ç›®æ ‡çš„å‡½æ•°
        function editGoal(index) {
            const goal = appData.goals[index];
            
            const modalHtml = `
                <div class="modal fade" id="editGoalModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">ç¼–è¾‘å­˜æ¬¾ç›®æ ‡</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="editGoalForm">
                                    <div class="mb-3">
                                        <label class="form-label">ç›®æ ‡åç§°</label>
                                        <input type="text" class="form-control" id="editGoalName" 
                                               value="${goal.name}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">ç›®æ ‡é‡‘é¢</label>
                                        <input type="text" class="form-control" id="editGoalAmount" 
                                               value="${goal.target}" required>
                                    </div>
                                    <input type="hidden" id="editGoalIndex" value="${index}">
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="saveEditedGoal()">ä¿å­˜</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('editGoalModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°çš„æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('editGoalModal'));
            modal.show();
        }

        // æ·»åŠ ä¿å­˜ç¼–è¾‘åçš„å­˜æ¬¾ç›®æ ‡å‡½æ•°
        function saveEditedGoal() {
            const index = parseInt(document.getElementById('editGoalIndex').value);
            const name = document.getElementById('editGoalName').value;
            const amountStr = document.getElementById('editGoalAmount').value;

            if (!name || !amountStr) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                return;
            }

            try {
                const amount = parseAmount(amountStr);
                
                appData.goals[index] = {
                    name: name,
                    target: amount
                };

                // æŒ‰ç›®æ ‡é‡‘é¢ä»å°åˆ°å¤§æ’åº
                appData.goals.sort((a, b) => a.target - b.target);

                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();

                const modal = bootstrap.Modal.getInstance(document.getElementById('editGoalModal'));
                modal.hide();
            } catch (error) {
                alert(error.message);
            }
        }

        // å°†ç¼–è¾‘å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.editGoal = editGoal;
        window.saveEditedGoal = saveEditedGoal;

        // æ·»åŠ å†å²è®°å½•å‡½æ•°
        function addHistory(type, amount, note) {
            const record = {
                id: Date.now(),  // ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID
                type: type,      // 'deposit' æˆ– 'withdraw'
                amount: amount,
                note: note || '',
                date: new Date().toISOString()
            };
            appData.history.unshift(record);  // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // åˆ é™¤å†å²è®°å½•å‡½æ•°
        function deleteHistory(id) {
            const index = appData.history.findIndex(record => record.id === id);
            if (index !== -1) {
                // æ¢å¤é‡‘é¢
                const record = appData.history[index];
                if (record.type === 'deposit') {
                    appData.totalSaved = SafeMoney.fromYuan(appData.totalSaved)
                        .subtract(record.amount).toYuan();
                } else {
                    appData.totalSaved = SafeMoney.fromYuan(appData.totalSaved)
                        .add(record.amount).toYuan();
                }
                // åˆ é™¤è®°å½•
                appData.history.splice(index, 1);
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();
            }
        }

        // ä¿®æ”¹æ˜¾ç¤ºå†å²è®°å½•çš„å‡½æ•°
        function displayHistory(container) {
            container.innerHTML = '';
            
            if (!appData.history || appData.history.length === 0) {
                container.innerHTML = '<div class="alert alert-info">æš‚æ— å†å²è®°å½•</div>';
                return;
            }

            // åˆ›å»ºå·¦å³å¸ƒå±€çš„å®¹å™¨
            const layoutDiv = document.createElement('div');
            layoutDiv.className = 'd-flex gap-3';
            container.appendChild(layoutDiv);

            // åˆ›å»ºå·¦ä¾§ç»Ÿè®¡åŒºåŸŸ
            const leftDiv = document.createElement('div');
            leftDiv.className = 'flex-shrink-0';
            leftDiv.style.width = '300px';
            leftDiv.innerHTML = `
                <div class="text-center mb-3">
                    <div class="btn-group">
                        <button class="btn btn-primary btn-sm" onclick="showStatistics('week', true)">æœ¬å‘¨ç»Ÿè®¡</button>
                        <button class="btn btn-primary btn-sm" onclick="showStatistics('month', true)">æœ¬æœˆç»Ÿè®¡</button>
                    </div>
                </div>
                <div id="statisticsContainer"></div>
            `;
            layoutDiv.appendChild(leftDiv);

            // åˆ›å»ºå³ä¾§å†å²è®°å½•åˆ—è¡¨
            const rightDiv = document.createElement('div');
            rightDiv.className = 'flex-grow-1';
            layoutDiv.appendChild(rightDiv);

            // åˆ›å»ºå†å²è®°å½•åˆ—è¡¨
            const historySection = document.createElement('div');
            historySection.className = 'history-section';

            appData.history.forEach((record) => {
                const recordDate = new Date(record.date);
                const card = document.createElement('div');
                card.className = 'card mb-2';
                
                const isDeposit = record.type === 'deposit';
                const operationClass = isDeposit ? 'text-success' : 'text-danger';
                const operationText = isDeposit ? 'å­˜' : 'å–';
                
                // ä¿®æ”¹æ˜¾ç¤ºå†å²è®°å½•çš„å‡½æ•°ä¸­çš„å¡ç‰‡éƒ¨åˆ†
                card.innerHTML = `
                    <div class="card-body p-2">
                        <div class="d-flex justify-content-between align-items-center w-100">
                            <div class="d-flex align-items-center gap-3 flex-grow-1">
                                <div style="min-width: 30px;">
                                    <span class="${operationClass} fw-bold">${operationText}</span>
                                </div>
                                <div style="min-width: 100px;">
                                    <span class="fw-bold ${operationClass}">${formatMoney(record.amount)}</span>
                                </div>
                                <div class="flex-grow-1">
                                    ${record.note ? `<span class="text-muted">${record.note}</span>` : ''}
                                </div>
                                <div style="min-width: 150px;">
                                    <small class="text-muted">${recordDate.toLocaleString('zh-CN')}</small>
                                </div>
                                <div>
                                    <button class="btn btn-danger btn-sm py-0 px-2" 
                                            style="font-size: 0.75rem;"
                                            onclick="deleteHistory(${record.id})">
                                        åˆ é™¤
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                historySection.appendChild(card);
            });

            rightDiv.appendChild(historySection);
        }

        // ä¿®æ”¹ç»Ÿè®¡åŠŸèƒ½æ˜¾ç¤ºæ–¹å¼
        function showStatistics(period, inPage = false) {
            const stats = calculateStatistics(period);
            const periodText = period === 'week' ? 'æœ¬å‘¨' : 'æœ¬æœˆ';
            
            const statsHtml = `
                <div class="statistics-container p-3 bg-light rounded">
                    <h6 class="text-center mb-3">${periodText}ç»Ÿè®¡</h6>
                    <div class="stat-card deposit mb-3">
                        <h6>å­˜æ¬¾ç»Ÿè®¡</h6>
                        <div class="stat-value text-success">${formatMoney(stats.totalDeposit)}</div>
                        <div class="stat-count">å…±${stats.deposits}ç¬”</div>
                    </div>
                    <div class="stat-card withdraw mb-3">
                        <h6>å–æ¬¾ç»Ÿè®¡</h6>
                        <div class="stat-value text-danger">${formatMoney(stats.totalWithdraw)}</div>
                        <div class="stat-count">å…±${stats.withdrawals}ç¬”</div>
                    </div>
                    <div class="net-change">
                        <h6>å‡€å˜åŒ–</h6>
                        <div class="stat-value ${stats.netChange >= 0 ? 'text-success' : 'text-danger'}">
                            ${formatMoney(stats.netChange)}
                        </div>
                    </div>
                </div>
            `;

            if (inPage) {
                // åœ¨é¡µé¢å·¦ä¾§æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                const container = document.getElementById('statisticsContainer');
                if (container) {
                    container.innerHTML = statsHtml;
                }
            } else {
                // å¼¹çª—æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆä¿ç•™åŸæœ‰åŠŸèƒ½ä»¥å¤‡ç”¨ï¼‰
                const modal = document.createElement('div');
                modal.className = 'modal fade';
                modal.innerHTML = `
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">${periodText}ç»Ÿè®¡</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                ${statsHtml}
                            </div>
                        </div>
                    </div>
                `;

                document.body.appendChild(modal);
                const modalInstance = new bootstrap.Modal(modal);
                modalInstance.show();
                
                modal.addEventListener('hidden.bs.modal', () => {
                    modal.remove();
                });
            }
        }

        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        function calculateStatistics(period) {
            const now = new Date();
            const stats = {
                deposits: 0,
                withdrawals: 0,
                totalDeposit: 0,
                totalWithdraw: 0,
                netChange: 0
            };

            appData.history.forEach(record => {
                const recordDate = new Date(record.date);
                let isInPeriod = false;

                if (period === 'week') {
                    // è®¡ç®—æœ¬å‘¨çš„å¼€å§‹æ—¶é—´ï¼ˆå‘¨ä¸€ï¼‰
                    const weekStart = new Date(now);
                    weekStart.setDate(now.getDate() - now.getDay() + (now.getDay() === 0 ? -6 : 1));
                    weekStart.setHours(0, 0, 0, 0);
                    isInPeriod = recordDate >= weekStart;
                } else {
                    // æœ¬æœˆ
                    isInPeriod = recordDate.getMonth() === now.getMonth() && 
                                recordDate.getFullYear() === now.getFullYear();
                }

                if (isInPeriod) {
                    if (record.type === 'deposit') {
                        stats.deposits++;
                        stats.totalDeposit += record.amount;
                    } else {
                        stats.withdrawals++;
                        stats.totalWithdraw += record.amount;
                    }
                }
            });

            stats.netChange = stats.totalDeposit - stats.totalWithdraw;
            return stats;
        }

        // æ·»åŠ ç›¸å…³æ ·å¼
        const statisticsStyle = `
        .statistics-container {
            padding: 1rem;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .stat-card.deposit {
            background: linear-gradient(145deg, #e8f5e9, #f8f9fa);
        }

        .stat-card.withdraw {
            background: linear-gradient(145deg, #fee8e7, #f8f9fa);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0.5rem 0;
        }

        .stat-count {
            color: #666;
            font-size: 0.9rem;
        }

        .net-change {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .history-header {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .history-section {
            background: #fff;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        `;

        // å°†æ ·å¼æ·»åŠ åˆ°æ–‡æ¡£ä¸­
        if (!document.getElementById('statistics-style')) {
            const style = document.createElement('style');
            style.id = 'statistics-style';
            style.textContent = statisticsStyle;
            document.head.appendChild(style);
        }

        // æ·»åŠ å½’æ¡£å‡½æ•°
        function archiveGoal(index, type = 'savings') {
            if (type === 'savings') {
                const goal = appData.goals[index];
                goal.archiveDate = new Date().toISOString();
                appData.archivedGoals.unshift(goal);
                appData.goals.splice(index, 1);
            } else if (type === 'age') {
                const goal = appData.ageGoals[index];
                goal.archiveDate = new Date().toISOString();
                appData.archivedAgeGoals.unshift(goal);
                appData.ageGoals.splice(index, 1);
            }
            renderViewMode();
        }

        // ä¿®æ”¹æ˜¾ç¤ºå½’æ¡£è®°å½•çš„å‡½æ•°
        function displayArchived(container) {
            container.innerHTML = '';
            
            if ((!appData.archivedGoals || appData.archivedGoals.length === 0) && 
                (!appData.archivedAgeGoals || appData.archivedAgeGoals.length === 0)) {
                container.innerHTML = '<div class="alert alert-info">æš‚æ— å½’æ¡£è®°å½•</div>';
                return;
            }

            // æ˜¾ç¤ºå½’æ¡£çš„å­˜æ¬¾ç›®æ ‡
            if (appData.archivedGoals && appData.archivedGoals.length > 0) {
                appData.archivedGoals.forEach((goal, index) => {
                    const archiveDate = new Date(goal.archiveDate);
                    const card = document.createElement('div');
                    card.className = 'card mb-2';
                    card.innerHTML = `
                        <div class="card-body p-2">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="d-flex align-items-center gap-1">
                                        <span class="text-success">[å­˜]</span>
                                        <span>${goal.name}</span>
                                        <span class="text-muted">-${formatMoney(goal.target)}</span>
                                    </div>
                                    <small class="text-muted">å½’æ¡£æ—¶é—´: ${archiveDate.toLocaleString('zh-CN')}</small>
                                </div>
                                <button class="btn btn-primary btn-sm py-0 px-2" 
                                        style="font-size: 0.75rem;"
                                        onclick="restoreArchivedGoal(${index}, 'savings')">æ¢å¤</button>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

            // æ˜¾ç¤ºå½’æ¡£çš„æ—¶é—´ç›®æ ‡
            if (appData.archivedAgeGoals && appData.archivedAgeGoals.length > 0) {
                appData.archivedAgeGoals.forEach((goal, index) => {
                    const archiveDate = new Date(goal.archiveDate);
                    const targetDate = parseDateString(goal.targetDate);
                    const formattedTargetDate = targetDate.toLocaleDateString('zh-CN');
                    
                    const card = document.createElement('div');
                    card.className = 'card mb-2';
                    card.innerHTML = `
                        <div class="card-body p-2">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="d-flex align-items-center gap-1">
                                        <span class="text-primary">[æ—¶]</span>
                                        <span>${goal.name}</span>
                                        <span class="text-muted">-${formattedTargetDate}</span>
                                    </div>
                                    <small class="text-muted">å½’æ¡£æ—¶é—´: ${archiveDate.toLocaleString('zh-CN')}</small>
                                </div>
                                <button class="btn btn-primary btn-sm py-0 px-2" 
                                        style="font-size: 0.75rem;"
                                        onclick="restoreArchivedGoal(${index}, 'age')">æ¢å¤</button>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }
        }

        // æ·»åŠ å½’æ¡£æ¨¡å¼çš„äº‹ä»¶ç›‘å¬
        document.getElementById('archiveMode').addEventListener('change', () => {
            if (document.getElementById('archiveMode').checked) {
                renderViewMode('archive');
            }
        });

        // ä¿®æ”¹æ¢å¤å½’æ¡£ç›®æ ‡çš„å‡½æ•°
        function restoreArchivedGoal(index, type = 'savings') {
            if (type === 'savings') {
                const goal = appData.archivedGoals[index];
                delete goal.archiveDate; // åˆ é™¤å½’æ¡£æ—¥æœŸ
                appData.goals.push(goal);
                // æŒ‰ç›®æ ‡é‡‘é¢æ’åº
                appData.goals.sort((a, b) => a.target - b.target);
                appData.archivedGoals.splice(index, 1);
            } else if (type === 'age') {
                const goal = appData.archivedAgeGoals[index];
                delete goal.archiveDate; // åˆ é™¤å½’æ¡£æ—¥æœŸ
                appData.ageGoals.push(goal);
                // æŒ‰æ—¥æœŸæ’åº
                appData.ageGoals.sort((a, b) => {
                    const dateA = parseDateString(a.targetDate);
                    const dateB = parseDateString(b.targetDate);
                    return dateA - dateB;
                });
                appData.archivedAgeGoals.splice(index, 1);
            }
            renderViewMode();
        }

        // å°†æ¢å¤å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.restoreArchivedGoal = restoreArchivedGoal;

        // æ·»åŠ æ¸…ç©ºå†å²è®°å½•çš„å‡½æ•°
        function clearHistory() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                appData.history = [];
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();
                showToast('å†å²è®°å½•å·²æ¸…ç©º');
            }
        }

        // æ·»åŠ æ¸…ç©ºå½’æ¡£è®°å½•çš„å‡½æ•°
        function clearArchived() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å½’æ¡£è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                appData.archivedGoals = [];
                appData.archivedAgeGoals = [];
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();
                showToast('å½’æ¡£è®°å½•å·²æ¸…ç©º');
            }
        }

        // æ·»åŠ æç¤ºå‡½æ•°
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // 2ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                toast.remove();
            }, 2000);
        }

        // ä¿®æ”¹æ˜¾ç¤ºå››è±¡é™å¾…åŠäº‹é¡¹çš„å‡½æ•°
        function displayTodos(container) {
            container.innerHTML = `
                <div class="quadrant-grid">
                    <div class="quadrant quadrant-1" data-quadrant="q1" ondrop="dropTodo(event)" ondragover="allowDrop(event)">
                        <div class="quadrant-header">
                            <h3 class="quadrant-title">é‡è¦ä¸”ç´§æ€¥</h3>
                        </div>
                        <div class="todo-list" id="q1-list"></div>
                        <div class="add-todo">
                            <input type="text" class="form-control" placeholder="æ·»åŠ å¾…åŠäº‹é¡¹">
                            <button class="btn btn-primary btn-sm" onclick="addTodo('q1')">æ·»åŠ </button>
                        </div>
                    </div>
                    <div class="quadrant quadrant-2" data-quadrant="q2" ondrop="dropTodo(event)" ondragover="allowDrop(event)">
                        <div class="quadrant-header">
                            <h3 class="quadrant-title">é‡è¦ä¸ç´§æ€¥</h3>
                        </div>
                        <div class="todo-list" id="q2-list"></div>
                        <div class="add-todo">
                            <input type="text" class="form-control" placeholder="æ·»åŠ å¾…åŠäº‹é¡¹">
                            <button class="btn btn-primary btn-sm" onclick="addTodo('q2')">æ·»åŠ </button>
                        </div>
                    </div>
                    <div class="quadrant quadrant-3" data-quadrant="q3" ondrop="dropTodo(event)" ondragover="allowDrop(event)">
                        <div class="quadrant-header">
                            <h3 class="quadrant-title">ç´§æ€¥ä¸é‡è¦</h3>
                        </div>
                        <div class="todo-list" id="q3-list"></div>
                        <div class="add-todo">
                            <input type="text" class="form-control" placeholder="æ·»åŠ å¾…åŠäº‹é¡¹">
                            <button class="btn btn-primary btn-sm" onclick="addTodo('q3')">æ·»åŠ </button>
                        </div>
                    </div>
                    <div class="quadrant quadrant-4" data-quadrant="q4" ondrop="dropTodo(event)" ondragover="allowDrop(event)">
                        <div class="quadrant-header">
                            <h3 class="quadrant-title">ä¸é‡è¦ä¸ç´§æ€¥</h3>
                        </div>
                        <div class="todo-list" id="q4-list"></div>
                        <div class="add-todo">
                            <input type="text" class="form-control" placeholder="æ·»åŠ å¾…åŠäº‹é¡¹">
                            <button class="btn btn-primary btn-sm" onclick="addTodo('q4')">æ·»åŠ </button>
                        </div>
                    </div>
                </div>
            `;

            // æ›´æ–°æ¯ä¸ªè±¡é™çš„å¾…åŠäº‹é¡¹åˆ—è¡¨
            ['q1', 'q2', 'q3', 'q4'].forEach(quadrant => {
                const list = document.getElementById(`${quadrant}-list`);
                list.ondragover = allowDrop;
                list.ondrop = dropTodo;
                
                appData.todos[quadrant].forEach((todo, index) => {
                    const item = document.createElement('div');
                    item.className = 'todo-item';
                    item.draggable = true;
                    item.setAttribute('data-quadrant', quadrant);
                    item.setAttribute('data-index', index);
                    
                    // æ·»åŠ æ‹–æ‹½äº‹ä»¶ç›‘å¬å™¨
                    item.ondragstart = dragTodo;
                    item.ondragend = dragEnd;
                    item.ondragover = (e) => {
                        e.preventDefault();
                        const draggingItem = document.querySelector('.dragging');
                        if (draggingItem !== item) {
                            const rect = item.getBoundingClientRect();
                            const midY = rect.top + rect.height / 2;
                            if (e.clientY < midY) {
                                item.classList.add('drag-over-top');
                                item.classList.remove('drag-over-bottom');
                            } else {
                                item.classList.add('drag-over-bottom');
                                item.classList.remove('drag-over-top');
                            }
                        }
                    };
                    item.ondragleave = () => {
                        item.classList.remove('drag-over-top', 'drag-over-bottom');
                    };
                    
                    item.innerHTML = `
                        <input type="checkbox" class="todo-checkbox" 
                               ${todo.completed ? 'checked' : ''} 
                               onchange="toggleTodo('${quadrant}', ${index})">
                        <span class="todo-text ${todo.completed ? 'completed' : ''}">${todo.text}</span>
                        <div class="todo-actions">
                            <button class="btn btn-danger btn-sm py-0 px-2" 
                                    onclick="deleteTodo('${quadrant}', ${index})">åˆ é™¤</button>
                        </div>
                    `;
                    list.appendChild(item);
                });
            });
        }

        // ä¿®æ”¹æ‹–æ‹½ç›¸å…³å‡½æ•°
        function dragTodo(event) {
            const item = event.target;
            item.classList.add('dragging');
            event.dataTransfer.setData('text/plain', JSON.stringify({
                quadrant: item.getAttribute('data-quadrant'),
                index: parseInt(item.getAttribute('data-index'))
            }));
        }

        function dragEnd(event) {
            event.target.classList.remove('dragging');
            // ç§»é™¤æ‰€æœ‰æ‹–æ‹½æŒ‡ç¤ºå™¨
            document.querySelectorAll('.drag-over-top, .drag-over-bottom').forEach(el => {
                el.classList.remove('drag-over-top', 'drag-over-bottom');
            });
        }

        function allowDrop(event) {
            event.preventDefault();
        }

        function dropTodo(event) {
            event.preventDefault();
            
            const data = JSON.parse(event.dataTransfer.getData('text/plain'));
            const sourceQuadrant = data.quadrant;
            const sourceIndex = data.index;
            
            // è·å–ç›®æ ‡è±¡é™å’Œä½ç½®
            let targetQuadrant = event.currentTarget.getAttribute('data-quadrant');
            if (!targetQuadrant) {
                // å¦‚æœæ‹–åˆ°äº†é¡¹ç›®ä¸Šï¼Œè·å–å…¶çˆ¶å…ƒç´ çš„è±¡é™
                const targetItem = event.target.closest('.todo-item');
                if (targetItem) {
                    targetQuadrant = targetItem.getAttribute('data-quadrant');
                }
            }
            
            if (!targetQuadrant) return;
            
            // è·å–æ‹–æ”¾ä½ç½®
            const targetList = document.getElementById(`${targetQuadrant}-list`);
            const items = Array.from(targetList.querySelectorAll('.todo-item'));
            let targetIndex = items.length;
            
            const targetItem = event.target.closest('.todo-item');
            if (targetItem) {
                targetIndex = parseInt(targetItem.getAttribute('data-index'));
                const rect = targetItem.getBoundingClientRect();
                const midY = rect.top + rect.height / 2;
                if (event.clientY > midY) {
                    targetIndex++;
                }
            }
            
            // ç§»åŠ¨å¾…åŠäº‹é¡¹
            const todo = appData.todos[sourceQuadrant][sourceIndex];
            appData.todos[sourceQuadrant].splice(sourceIndex, 1);
            
            if (sourceQuadrant === targetQuadrant) {
                // åŒä¸€è±¡é™å†…ç§»åŠ¨
                if (targetIndex > sourceIndex) {
                    targetIndex--;
                }
                appData.todos[targetQuadrant].splice(targetIndex, 0, todo);
            } else {
                // ä¸åŒè±¡é™é—´ç§»åŠ¨
                appData.todos[targetQuadrant].splice(targetIndex, 0, todo);
            }
            
            // æ›´æ–°UI
            renderViewMode();
        }

        // æ·»åŠ å¾…åŠäº‹é¡¹
        function addTodo(quadrant) {
            const input = document.querySelector(`.quadrant-${quadrant.slice(-1)} .add-todo input`);
            const text = input.value.trim();
            
            if (text) {
                appData.todos[quadrant].push({
                    text: text,
                    completed: false,
                    createdAt: new Date().toISOString()
                });
                input.value = '';
                renderViewMode();
            }
        }

        // åˆ‡æ¢å¾…åŠäº‹é¡¹çŠ¶æ€
        function toggleTodo(quadrant, index) {
            appData.todos[quadrant][index].completed = !appData.todos[quadrant][index].completed;
            renderViewMode();
        }

        // åˆ é™¤å¾…åŠäº‹é¡¹
        function deleteTodo(quadrant, index) {
            appData.todos[quadrant].splice(index, 1);
            renderViewMode();
        }

        // æ·»åŠ å››è±¡é™å¾…åŠäº‹é¡¹æ¨¡å¼çš„äº‹ä»¶ç›‘å¬
        document.getElementById('todoMode').addEventListener('change', () => {
            if (document.getElementById('todoMode').checked) {
                renderViewMode('todo');
            }
        });

        // æ·»åŠ çµæ„Ÿç®¡ç†ç›¸å…³çš„å‡½æ•°
        function addInspiration() {
            const name = prompt('è¯·è¾“å…¥çµæ„Ÿåç§°:');
            const category = prompt('è¯·é€‰æ‹©çµæ„Ÿåˆ†ç±»:');
            const content = prompt('è¯·è¾“å…¥çµæ„Ÿå†…å®¹:');

            if (name && category && content) {
                const newInspiration = {
                    id: Date.now().toString(),
                    number: 1,
                    title: name,
                    category: category,
                    content: content,
                    createTime: Date.now(),
                    updateTime: Date.now()
                };
                appData.inspirations.push(newInspiration);
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode();
                alert('çµæ„Ÿæ·»åŠ æˆåŠŸï¼');
            }
        }

        // æ˜¾ç¤ºçµæ„Ÿç®¡ç†ç•Œé¢
        function showInspirationModal() {
            const modalHtml = `
                <div class="modal fade" id="inspirationModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">æ·»åŠ çµæ„Ÿ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="inspirationForm">
                                    <div class="mb-3">
                                        <label class="form-label">çµæ„Ÿåç§°</label>
                                        <input type="text" class="form-control" id="inspirationName" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">çµæ„Ÿåˆ†ç±»</label>
                                        <select class="form-select" id="inspirationCategory">
                                            <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                                            ${appData.inspirationTags.map(tag => `
                                                <option value="${tag}">${tag}</option>
                                            `).join('')}
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">çµæ„Ÿå†…å®¹</label>
                                        <textarea class="form-control" id="inspirationContent" rows="3" required></textarea>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="addInspiration()">ä¿å­˜</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            if (!document.getElementById('inspirationModal')) {
                document.body.insertAdjacentHTML('beforeend', modalHtml);
            } else {
                document.getElementById('inspirationModal').outerHTML = modalHtml;
            }

            const modal = new bootstrap.Modal(document.getElementById('inspirationModal'));
            modal.show();
        }

        // ç¡®ä¿æ·»åŠ çµæ„ŸæŒ‰é’®æ­£å¸¸å·¥ä½œ
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            document.body.addEventListener('click', function(e) {
                if (e.target.matches('.add-inspiration-btn') || e.target.closest('.add-inspiration-btn')) {
                    showInspirationModal();
                }
            });
        });

        // æ·»åŠ çµæ„Ÿåˆ—è¡¨çš„å‡½æ•°
        function displayInspirationList() {
            const listContainer = document.getElementById('inspirationList');
            listContainer.innerHTML = '';

            appData.inspirations.forEach(inspiration => {
                const item = document.createElement('div');
                item.className = 'inspiration-item';
                item.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-2">
                            <span class="inspiration-number">${inspiration.number}</span>
                            <div class="inspiration-content">
                                <h5 class="inspiration-title">${inspiration.title}</h5>
                                <p class="inspiration-text">${inspiration.content}</p>
                                <small class="inspiration-time">åˆ›å»ºæ—¶é—´: ${new Date(inspiration.createTime).toLocaleString()}</small>
                            </div>
                        </div>
                        <div class="inspiration-actions">
                            <button class="btn btn-primary btn-sm" onclick="editInspiration(${inspiration.id})">ç¼–è¾‘</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteInspiration(${inspiration.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `;
                listContainer.appendChild(item);
            });
        }

        // ä¿®æ”¹ç¼–è¾‘çµæ„Ÿå‡½æ•°
        function editInspiration(id) {
            const inspiration = appData.inspirations.find(inspiration => inspiration.id === id);
            if (inspiration) {
                const modalHtml = `
                    <div class="modal fade" id="editInspirationModal" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">ç¼–è¾‘çµæ„Ÿ</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <form id="editInspirationForm">
                                        <div class="mb-3">
                                            <label class="form-label">æ ‡ç­¾</label>
                                            <div class="tag-selection">
                                                ${appData.inspirationTags.map(tag => `
                                                    <div class="form-check form-check-inline">
                                                        <input class="form-check-input" type="checkbox" 
                                                               id="edit-tag-${tag}" value="${tag}"
                                                               ${(inspiration.tags || []).includes(tag) ? 'checked' : ''}>
                                                        <label class="form-check-label" for="edit-tag-${tag}">${tag}</label>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">çµæ„Ÿå†…å®¹</label>
                                            <textarea class="form-control" id="editInspirationContent" rows="3" required>${inspiration.content}</textarea>
                                        </div>
                                        <input type="hidden" id="editInspirationId" value="${inspiration.id}">
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                    <button type="button" class="btn btn-primary" onclick="saveEditedInspiration()">ä¿å­˜</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
                const existingModal = document.getElementById('editInspirationModal');
                if (existingModal) {
                    existingModal.remove();
                }

                // æ·»åŠ æ–°çš„æ¨¡æ€æ¡†
                document.body.insertAdjacentHTML('beforeend', modalHtml);

                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                const modal = new bootstrap.Modal(document.getElementById('editInspirationModal'));
                modal.show();
            }
        }

        // ä¿®æ”¹ä¿å­˜ç¼–è¾‘åçš„çµæ„Ÿå‡½æ•°
        function saveEditedInspiration() {
            const id = document.getElementById('editInspirationId').value;
            const content = document.getElementById('editInspirationContent').value;
            
            // è·å–é€‰ä¸­çš„æ ‡ç­¾
            const selectedTags = appData.inspirationTags
                .filter(tag => document.getElementById(`edit-tag-${tag}`).checked);

            if (!content) {
                alert('è¯·å¡«å†™çµæ„Ÿå†…å®¹');
                return;
            }

            const inspiration = appData.inspirations.find(insp => insp.id === id);
            if (inspiration) {
                inspiration.content = content;
                inspiration.tags = selectedTags;
                inspiration.updateTime = Date.now();
                
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                
                // å…³é—­æ¨¡æ€æ¡†
                const modal = bootstrap.Modal.getInstance(document.getElementById('editInspirationModal'));
                modal.hide();
                // æ›´æ–°ç•Œé¢
                renderViewMode();
            }
        }

        // å°†ç¼–è¾‘å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.editInspiration = editInspiration;
        window.saveEditedInspiration = saveEditedInspiration;

        // åˆ é™¤çµæ„Ÿå‡½æ•°
        function deleteInspiration(id) {
            appData.inspirations = appData.inspirations.filter(inspiration => inspiration.id !== id);
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode();
        }

        // æ·»åŠ çµæ„Ÿåˆ—è¡¨çš„äº‹ä»¶ç›‘å¬
        document.getElementById('inspirationMode').addEventListener('change', () => {
            if (document.getElementById('inspirationMode').checked) {
                renderViewMode('inspiration');
            }
        });

        // æ˜¾ç¤ºçµæ„Ÿåˆ—è¡¨
        document.getElementById('inspirationMode').addEventListener('change', displayInspirationList);

        // æ·»åŠ æ‹–æ‹½æ’åºç›¸å…³çš„å‡½æ•°
        function initDragAndDrop() {
            const items = document.querySelectorAll('.inspiration-item');
            const container = document.querySelector('.inspiration-grid');

            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.target.classList.add('dragging');
                });

                item.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                    updateInspirationNumbers();
                });
            });

            container.addEventListener('dragover', (e) => {
                e.preventDefault();
                const draggable = document.querySelector('.dragging');
                const afterElement = getDragAfterElement(container, e.clientY);
                
                if (afterElement == null) {
                    container.appendChild(draggable);
                } else {
                    container.insertBefore(draggable, afterElement);
                }
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.inspiration-item:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function updateInspirationNumbers() {
            const items = document.querySelectorAll('.inspiration-item');
            const newOrder = [];
            
            items.forEach((item, index) => {
                const id = item.dataset.id;
                const inspiration = appData.inspirations.find(insp => insp.id === id);
                if (inspiration) {
                    inspiration.number = index + 1;
                    newOrder.push(inspiration);
                }
            });

            appData.inspirations = newOrder;
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode();
        }

        // ä¿®æ”¹æ˜¾ç¤ºçµæ„Ÿåˆ—è¡¨çš„å‡½æ•°ï¼Œæ·»åŠ æ‹–æ‹½åŠŸèƒ½
        function displayInspirations(container) {
            // è·å–å½“å‰è§†å›¾æ¨¡å¼
            const viewMode = localStorage.getItem('inspiration_view_mode') || 'grid';
            
            container.innerHTML = `
                <div class="inspiration-header">
                    <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="inspiration-search">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="æœç´¢çµæ„Ÿ..." onkeyup="searchInspirations(this.value)">
                        </div>
                        <div class="view-switch">
                            <button class="${viewMode === 'grid' ? 'active' : ''}" onclick="switchView('grid')" title="ç½‘æ ¼è§†å›¾">
                                <i class="fas fa-th-large"></i> ç½‘æ ¼
                            </button>
                            <button class="${viewMode === 'timeline' ? 'active' : ''}" onclick="switchView('timeline')" title="æ—¶é—´çº¿è§†å›¾">
                                <i class="fas fa-stream"></i> æ—¶é—´çº¿
                            </button>
                        </div>
                        <div class="inspiration-actions-group">
                            <button class="btn btn-danger btn-sm" id="batchDeleteBtn" style="display:none" onclick="batchDeleteInspirations()" title="åˆ é™¤é€‰ä¸­çš„çµæ„Ÿ">
                                <i class="fas fa-trash"></i> åˆ é™¤é€‰ä¸­
                            </button>
                            <button class="btn btn-success btn-sm" id="batchMergeBtn" style="display:none" onclick="showMergeModal()" title="åˆå¹¶é€‰ä¸­çš„çµæ„Ÿ">
                                <i class="fas fa-object-group"></i> åˆå¹¶é€‰ä¸­
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="showBulkInputModal()" title="æ‰¹é‡å¯¼å…¥çµæ„Ÿ">
                                <i class="fas fa-file-import"></i> æ‰¹é‡å¯¼å…¥
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="showAddInspirationModal()" title="æ·»åŠ æ–°çµæ„Ÿ">
                                <i class="fas fa-plus"></i> æ·»åŠ 
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="showAddTagModal()" title="ç®¡ç†æ ‡ç­¾">
                                <i class="fas fa-tags"></i> æ ‡ç­¾
                            </button>
                        </div>
                    </div>
                </div>

                <div class="inspiration-filters">
                    <div class="tag-buttons">
                        <button class="tag-btn active" onclick="filterInspirations('all')">å…¨éƒ¨</button>
                        ${appData.inspirationTags.map(tag => `
                            <button class="tag-btn" onclick="filterInspirations('${tag}')">${tag}</button>
                        `).join('')}
                    </div>
                </div>

                <div class="${viewMode === 'grid' ? 'inspiration-grid' : 'timeline-view'}" id="inspirationContainer">
                    ${viewMode === 'grid' ? displayGridView() : displayTimelineView()}
                </div>
            `;

            // åˆå§‹åŒ–æ‹–æ‹½åŠŸèƒ½ï¼ˆä»…åœ¨ç½‘æ ¼è§†å›¾æ—¶ï¼‰
            if (viewMode === 'grid') {
                initDragAndDrop();
            }
        }

        // æ·»åŠ è§†å›¾åˆ‡æ¢å‡½æ•°
        function switchView(mode) {
            localStorage.setItem('inspiration_view_mode', mode);
            const container = document.getElementById('inspirationContainer');
            container.className = mode === 'grid' ? 'inspiration-grid' : 'timeline-view';
            container.innerHTML = mode === 'grid' ? displayGridView() : displayTimelineView();
            
            // é‡æ–°åˆå§‹åŒ–æ‹–æ‹½åŠŸèƒ½ï¼ˆä»…åœ¨ç½‘æ ¼è§†å›¾æ—¶ï¼‰
            if (mode === 'grid') {
                initDragAndDrop();
            }

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-switch button').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase().includes(mode));
            });
        }

        // æ·»åŠ ç½‘æ ¼è§†å›¾æ˜¾ç¤ºå‡½æ•°
        function displayGridView() {
            return appData.inspirations
                .sort((a, b) => a.number - b.number)
                .map(inspiration => `
                    <div class="inspiration-item" draggable="true" data-id="${inspiration.id}">
                        <div class="inspiration-header-row">
                            <div class="inspiration-checkbox">
                                <input type="checkbox" class="inspiration-select" onchange="toggleInspiration(this)">
                            </div>
                            <div class="inspiration-number">${inspiration.number}</div>
                            <div class="inspiration-content">
                                <div class="inspiration-text">${inspiration.content}</div>
                            </div>
                        </div>
                        <div class="inspiration-footer">
                            <div class="inspiration-info">
                                <div class="inspiration-tags">
                                    ${(inspiration.tags || []).map(tag => `
                                        <span class="inspiration-tag">${tag}</span>
                                    `).join('')}
                                </div>
                                <div class="inspiration-time">
                                    æœ€åæ›´æ–°: ${formatDate(inspiration.updateTime)}
                                </div>
                            </div>
                            <div class="inspiration-actions">
                                <button class="btn-edit" onclick="editInspiration('${inspiration.id}')">
                                    <i class="fas fa-edit"></i> ç¼–è¾‘
                                </button>
                                <button class="btn-delete" onclick="deleteInspiration('${inspiration.id}')">
                                    <i class="fas fa-trash"></i> åˆ é™¤
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
        }

        // æ·»åŠ æ—¶é—´çº¿è§†å›¾æ˜¾ç¤ºå‡½æ•°
        function displayTimelineView() {
            // æŒ‰æ—¥æœŸåˆ†ç»„
            const groups = {};
            appData.inspirations
                .sort((a, b) => b.createTime - a.createTime) // æŒ‰åˆ›å»ºæ—¶é—´å€’åºæ’åˆ—
                .forEach(inspiration => {
                    const date = new Date(inspiration.createTime).toLocaleDateString('zh-CN');
                    if (!groups[date]) {
                        groups[date] = [];
                    }
                    groups[date].push(inspiration);
                });

            // ç”Ÿæˆæ—¶é—´çº¿HTML
            return Object.entries(groups).map(([date, inspirations]) => `
                <div class="timeline-group">
                    <div class="timeline-date">${date}</div>
                    <div class="timeline-items">
                        ${inspirations.map(inspiration => `
                            <div class="timeline-item" data-id="${inspiration.id}">
                                <div class="inspiration-content">
                                    <div class="inspiration-text">${inspiration.content}</div>
                                    <div class="inspiration-footer mt-2">
                                        <div class="inspiration-tags">
                                            ${(inspiration.tags || []).map(tag => `
                                                <span class="inspiration-tag">${tag}</span>
                                            `).join('')}
                                        </div>
                                        <div class="inspiration-time text-muted small">
                                            ${new Date(inspiration.createTime).toLocaleTimeString('zh-CN', {
                                                hour: '2-digit',
                                                minute: '2-digit'
                                            })}
                                        </div>
                                        <div class="inspiration-actions mt-2">
                                            <button class="btn-edit" onclick="editInspiration('${inspiration.id}')">
                                                <i class="fas fa-edit"></i> ç¼–è¾‘
                                            </button>
                                            <button class="btn-delete" onclick="deleteInspiration('${inspiration.id}')">
                                                <i class="fas fa-trash"></i> åˆ é™¤
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        // å°†è§†å›¾åˆ‡æ¢å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.switchView = switchView;

        // ä¿®æ”¹ä¿å­˜æ‰¹é‡çµæ„Ÿçš„å‡½æ•°
        function saveBulkInspirations() {
            const content = document.getElementById('bulkContent').value.trim();
            if (!content) {
                alert('è¯·è¾“å…¥çµæ„Ÿå†…å®¹');
                return;
            }

            // æŒ‰æ¢è¡Œç¬¦åˆ†å‰²å†…å®¹ï¼Œå¹¶è¿‡æ»¤ç©ºè¡Œ
            const inspirations = content.split(/\n/)
                .map(text => text.trim())
                .filter(text => text)
                .map(text => {
                    // å»é™¤å¸¸è§çš„åºå·æ ¼å¼ï¼š
                    // 1. æ•°å­—åŠ ç‚¹: "1. "
                    // 2. æ•°å­—åŠ æ‹¬å·: "1) " æˆ– "(1) "
                    // 3. ä¸­æ–‡æ•°å­—åŠ é¡¿å·æˆ–ç‚¹: "ä¸€ã€" æˆ– "ä¸€. "
                    return text.replace(/^(\d+[\.\)ï¼½\ã€‘]|\(\d+\)|[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒä¸‡]+[ã€\.])\s*/, '').trim();
                });

            // è·å–å½“å‰æœ€å¤§ç¼–å·
            const maxNumber = appData.inspirations.reduce((max, insp) => 
                Math.max(max, insp.number || 0), 0);

            // å®šä¹‰æ ‡ç­¾å…³é”®è¯æ˜ å°„
            const tagKeywords = {
                'å·¥ä½œ': ['å·¥ä½œ', 'èŒä¸š', 'äº‹ä¸š', 'å·¥èµ„', 'è–ªèµ„', 'å…¬å¸', 'è€æ¿', 'åŒäº‹', 'å®¢æˆ·', 'é¡¹ç›®', 'ä¼šè®®', 'æ±‡æŠ¥', 'æ™‹å‡', 'èŒä½', 'åŠå…¬'],
                'å­¦ä¹ ': ['å­¦ä¹ ', 'çŸ¥è¯†', 'è¯¾ç¨‹', 'è€ƒè¯•', 'è¯»ä¹¦', 'ç¬”è®°', 'ç ”ç©¶', 'å­¦æ ¡', 'æ•™è‚²', 'åŸ¹è®­', 'æŠ€èƒ½', 'æˆé•¿', 'è¿›æ­¥', 'æ€è€ƒ', 'ç†è§£', 'å¤ä¹ ', 'ç»ƒä¹ '],
                'ç”Ÿæ´»': ['ç”Ÿæ´»', 'å®¶åº­', 'å¥åº·', 'è¿åŠ¨', 'é¥®é£Ÿ', 'ä¼‘æ¯', 'å¨±ä¹', 'æ—…è¡Œ', 'è´­ç‰©', 'æœ‹å‹', 'ç¤¾äº¤', 'çˆ±å¥½', 'å…´è¶£', 'å¿ƒæƒ…', 'æ„Ÿå—'],
                'å…¶ä»–': []  // å…¶ä»–ç±»åˆ«ä½œä¸ºé»˜è®¤åˆ†ç±»ï¼Œä¸éœ€è¦å…³é”®è¯
            };

            // æ‰¹é‡æ·»åŠ çµæ„Ÿ
            inspirations.forEach((text, index) => {
                // è‡ªåŠ¨è¯†åˆ«æ ‡ç­¾
                const matchedTags = [];
                for (const [tag, keywords] of Object.entries(tagKeywords)) {
                    // æ£€æŸ¥å†…å®¹æ˜¯å¦åŒ…å«è¯¥æ ‡ç­¾çš„ä»»ä½•å…³é”®è¯
                    if (keywords.some(keyword => text.includes(keyword))) {
                        matchedTags.push(tag);
                    }
                }
                
                // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•æ ‡ç­¾ï¼Œæ·»åŠ "å…¶ä»–"æ ‡ç­¾
                if (matchedTags.length === 0) {
                    matchedTags.push('å…¶ä»–');
                }

                const newInspiration = {
                    id: Date.now() + index.toString(),
                    number: maxNumber + index + 1,
                    content: text,
                    tags: matchedTags,
                    createTime: Date.now(),
                    updateTime: Date.now()
                };
                appData.inspirations.push(newInspiration);
            });

            // ä¿å­˜æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));

            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('bulkInputModal'));
            modal.hide();

            // æ›´æ–°ç•Œé¢
            renderViewMode();
            showToast('æ‰¹é‡å¯¼å…¥æˆåŠŸ');
        }

        // ä¿®æ”¹æ‰¹é‡å¯¼å…¥æ¨¡æ€æ¡†çš„æç¤ºæ–‡æœ¬
        function showBulkInputModal() {
            const content = `
                <div class="mb-3">
                    <label class="form-label">è¯·è¾“å…¥çµæ„Ÿå†…å®¹(æ¯è¡Œä¸€æ¡çµæ„Ÿï¼Œè‡ªåŠ¨å»é™¤åºå·)</label>
                    <div class="text-muted small mb-2">ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å†…å®¹å¹¶æ·»åŠ åˆé€‚çš„æ ‡ç­¾</div>
                    <textarea class="form-control" id="bulkContent" rows="10" 
                            placeholder="1. ç¬¬ä¸€æ¡çµæ„Ÿ
2. ç¬¬äºŒæ¡çµæ„Ÿ
3. ç¬¬ä¸‰æ¡çµæ„Ÿ"></textarea>
                </div>
            `;

            const modalHtml = createModal({
                id: 'bulkInputModal',
                title: 'æ‰¹é‡å¯¼å…¥çµæ„Ÿ',
                content: content,
                onSave: 'saveBulkInspirations()'
            });

            const existingModal = document.getElementById('bulkInputModal');
            if (existingModal) {
                existingModal.remove();
            }
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            const modal = new bootstrap.Modal(document.getElementById('bulkInputModal'));
            modal.show();
        }

        // æ·»åŠ æ ¼å¼åŒ–æ—¥æœŸçš„å‡½æ•°
        function formatDate(timestamp) {
            return new Date(timestamp).toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // ä¿®æ”¹æ ‡ç­¾ç®¡ç†æ¨¡æ€æ¡†å‡½æ•°
        function showAddTagModal() {
            const modalHtml = `
                <div class="modal fade" id="addTagModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">ç®¡ç†æ ‡ç­¾</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label">æ·»åŠ æ–°æ ‡ç­¾</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="newTagInput" placeholder="è¾“å…¥æ–°æ ‡ç­¾">
                                        <button class="btn btn-primary" type="button" onclick="addNewTag()">æ·»åŠ </button>
                                    </div>
                                </div>
                                <div class="current-tags">
                                    <label class="form-label">å½“å‰æ ‡ç­¾</label>
                                    <div class="tag-list" id="tagList">
                                        ${renderTagList()}
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('addTagModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°çš„æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('addTagModal'));
            modal.show();
        }

        // ä¿®æ”¹æ˜¾ç¤ºæ ‡ç­¾åˆ—è¡¨çš„å‡½æ•°
        function renderTagList() {
            return appData.inspirationTags.map(tag => {
                // ç¡®ä¿tagæ˜¯å­—ç¬¦ä¸²
                const tagStr = typeof tag === 'object' ? (tag.name || tag.toString()) : tag;
                return `
                    <div class="tag-item">
                        <span>${tagStr}</span>
                        <button type="button" class="btn btn-sm" onclick="deleteTag('${tagStr}')">Ã—</button>
                    </div>
                `;
            }).join('');
        }

        // ä¿®æ”¹æ·»åŠ æ–°æ ‡ç­¾çš„å‡½æ•°
        function addNewTag() {
            const input = document.getElementById('newTagInput');
            const tag = input.value.trim();
            
            if (!tag) {
                alert('è¯·è¾“å…¥æ ‡ç­¾åç§°');
                return;
            }
            
            // ç¡®ä¿æ ‡ç­¾æ˜¯å­—ç¬¦ä¸²å½¢å¼
            if (appData.inspirationTags.includes(tag) || appData.inspirationTags.some(t => 
                (typeof t === 'object' && (t.name === tag || t.toString() === tag)))) {
                alert('è¯¥æ ‡ç­¾å·²å­˜åœ¨');
                return;
            }
            
            // ç›´æ¥æ·»åŠ å­—ç¬¦ä¸²å½¢å¼çš„æ ‡ç­¾
            appData.inspirationTags.push(tag);
            
            // ä¿®å¤ç°æœ‰çš„æ ‡ç­¾æ•°æ®
            appData.inspirationTags = appData.inspirationTags.map(t => 
                typeof t === 'object' ? (t.name || t.toString()) : t
            );
            
            // ä¿®å¤æ‰€æœ‰çµæ„Ÿä¸­çš„æ ‡ç­¾æ•°æ®
            appData.inspirations.forEach(inspiration => {
                if (inspiration.tags) {
                    inspiration.tags = inspiration.tags.map(t => 
                        typeof t === 'object' ? (t.name || t.toString()) : t
                    );
                }
            });
            
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            
            // æ›´æ–°æ ‡ç­¾åˆ—è¡¨
            const tagList = document.getElementById('tagList');
            if (tagList) {
                tagList.innerHTML = renderTagList();
            }
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';
            
            // æ›´æ–°ä¸»ç•Œé¢
            renderViewMode();
        }

        // ä¿®æ”¹åˆ é™¤æ ‡ç­¾çš„å‡½æ•°
        function deleteTag(tag) {
            appData.inspirationTags = appData.inspirationTags.filter(t => 
                typeof t === 'object' ? (t.name !== tag && t.toString() !== tag) : t !== tag
            );
            
            // ä»æ‰€æœ‰çµæ„Ÿä¸­ç§»é™¤è¯¥æ ‡ç­¾
            appData.inspirations.forEach(inspiration => {
                if (inspiration.tags) {
                    inspiration.tags = inspiration.tags.filter(t => 
                        typeof t === 'object' ? (t.name !== tag && t.toString() !== tag) : t !== tag
                    );
                }
            });
            
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            
            // æ›´æ–°æ ‡ç­¾åˆ—è¡¨
            const tagList = document.getElementById('tagList');
            if (tagList) {
                tagList.innerHTML = renderTagList();
            }
            
            // æ›´æ–°ä¸»ç•Œé¢
            renderViewMode();
        }

        // æ·»åŠ æ•°æ®ä¿®å¤å‡½æ•°
        function fixTagData() {
            // ä¿®å¤æ ‡ç­¾åˆ—è¡¨
            if (Array.isArray(appData.inspirationTags)) {
                appData.inspirationTags = appData.inspirationTags.map(tag => 
                    typeof tag === 'object' ? (tag.name || tag.toString()) : tag
                );
            } else {
                appData.inspirationTags = ['å·¥ä½œ', 'å­¦ä¹ ', 'ç”Ÿæ´»', 'å…¶ä»–'];
            }
            
            // ä¿®å¤çµæ„Ÿä¸­çš„æ ‡ç­¾
            if (Array.isArray(appData.inspirations)) {
                appData.inspirations.forEach(inspiration => {
                    if (inspiration.tags) {
                        inspiration.tags = inspiration.tags.map(tag => 
                            typeof tag === 'object' ? (tag.name || tag.toString()) : tag
                        );
                    }
                });
            }
            
            // ä¿å­˜ä¿®å¤åçš„æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // å°†æ ‡ç­¾ç®¡ç†ç›¸å…³å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.showAddTagModal = showAddTagModal;
        window.addNewTag = addNewTag;
        window.deleteTag = deleteTag;

        // ä¿®æ”¹ç­›é€‰å‡½æ•°
        function filterInspirations(tag) {
            const filters = document.querySelectorAll('.inspiration-filter');
            filters.forEach(filter => {
                filter.classList.toggle('active', filter.textContent === tag || (tag === 'all' && filter.textContent === 'å…¨éƒ¨'));
            });

            const items = document.querySelectorAll('.inspiration-item');
            items.forEach(item => {
                const id = item.dataset.id;
                const inspiration = appData.inspirations.find(insp => insp.id === id);
                if (tag === 'all' || (inspiration.tags && inspiration.tags.includes(tag))) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // æ·»åŠ æœç´¢çµæ„Ÿçš„å‡½æ•°
        function searchInspirations(keyword) {
            const items = document.querySelectorAll('.inspiration-item');
            keyword = keyword.toLowerCase().trim();
            
            items.forEach(item => {
                const id = item.dataset.id;
                const inspiration = appData.inspirations.find(insp => insp.id === id);
                const content = inspiration.content.toLowerCase();
                const tags = inspiration.tags ? inspiration.tags.join(' ').toLowerCase() : '';
                
                if (!keyword || content.includes(keyword) || tags.includes(keyword)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // 1. æ·»åŠ æ˜¾ç¤ºå­˜æ¬¾ç›®æ ‡çš„ç‹¬ç«‹å‡½æ•°
        function displaySavingsGoals(container) {
            appData.goals.forEach((goal, index) => {
                const totalMoney = SafeMoney.fromYuan(appData.totalSaved);
                const targetMoney = SafeMoney.fromYuan(goal.target);
                
                // è®¡ç®—è¿›åº¦
                const progress = Math.min((totalMoney.value / targetMoney.value) * 100, 100);
                
                const card = document.createElement('div');
                card.className = 'card mb-3';
                
                // è®¡ç®—å‰©ä½™é‡‘é¢
                const remainingMoney = SafeMoney.fromYuan(goal.target).subtract(appData.totalSaved);
                
                // ç¡®å®šè¿›åº¦æ¡çŠ¶æ€
                const progressClass = progress >= 80 ? 'high' : progress >= 50 ? 'medium' : 'low';
                
                card.innerHTML = `
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title">${goal.name}</h5>
                            <div class="d-flex gap-2">
                                ${progress >= 100 ? `
                                    <button class="btn btn-success btn-sm py-0 px-2" onclick="archiveGoal(${index}, 'savings')">å½’æ¡£</button>
                                ` : ''}
                                <button class="btn btn-primary btn-sm py-0 px-2" onclick="editGoal(${index})">ç¼–è¾‘</button>
                                <button class="btn btn-danger btn-sm py-0 px-2" onclick="deleteGoal(${index})">åˆ é™¤</button>
                            </div>
                        </div>
                        <div class="progress-wrapper">
                            <div class="amount-display-wrapper">
                                <div class="amount-item">
                                    <div class="amount-label">å½“å‰å­˜æ¬¾</div>
                                    <div class="amount-value">${formatMoney(appData.totalSaved)}</div>
                                </div>
                                <div class="amount-item">
                                    <div class="amount-label">ç›®æ ‡é‡‘é¢</div>
                                    <div class="amount-value">${formatMoney(goal.target)}</div>
                                </div>
                            </div>
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated ${progressClass}"
                                     role="progressbar"
                                     style="width: ${progress}%"
                                     aria-valuenow="${progress}"
                                     aria-valuemin="0"
                                     aria-valuemax="100">
                                    ${progress.toFixed(1)}%
                                </div>
                            </div>
                            <div class="remaining-amount">
                                è¿˜éœ€å­˜æ¬¾: ${formatMoney(remainingMoney.toYuan())}
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // 2. æ·»åŠ æ˜¾ç¤ºæ·»åŠ çµæ„Ÿæ¨¡æ€æ¡†çš„å‡½æ•°
        function showAddInspirationModal() {
            const modalHtml = `
                <div class="modal fade" id="addInspirationModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">æ·»åŠ çµæ„Ÿ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="addInspirationForm">
                                    <div class="mb-3">
                                        <label class="form-label">å†…å®¹</label>
                                        <textarea class="form-control" id="addInspirationContent" rows="3" required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">æ ‡ç­¾</label>
                                        <div class="tag-selection">
                                            ${appData.inspirationTags.map(tag => `
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" 
                                                           id="tag-${tag}" value="${tag}">
                                                    <label class="form-check-label" for="tag-${tag}">${tag}</label>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="saveNewInspiration()">ä¿å­˜</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('addInspirationModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°çš„æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('addInspirationModal'));
            modal.show();
        }

        // 3. æ·»åŠ ä¿å­˜æ–°çµæ„Ÿçš„å‡½æ•°
        function saveNewInspiration() {
            const content = document.getElementById('addInspirationContent').value.trim();
            
            // è·å–é€‰ä¸­çš„æ ‡ç­¾
            const selectedTags = appData.inspirationTags
                .filter(tag => document.getElementById(`tag-${tag}`).checked);

            if (!content) {
                alert('è¯·å¡«å†™å†…å®¹');
                return;
            }

            // è·å–å½“å‰æœ€å¤§ç¼–å·
            const maxNumber = appData.inspirations.reduce((max, insp) => 
                Math.max(max, insp.number || 0), 0);

            // åˆ›å»ºæ–°çµæ„Ÿ
            const newInspiration = {
                id: Date.now().toString(),
                number: maxNumber + 1,
                content: content,
                tags: selectedTags,
                createTime: Date.now(),
                updateTime: Date.now()
            };

            // æ·»åŠ åˆ°çµæ„Ÿåˆ—è¡¨
            appData.inspirations.push(newInspiration);

            // ä¿å­˜æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));

            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('addInspirationModal'));
            modal.hide();

            // æ›´æ–°ç•Œé¢
            renderViewMode();
        }

        // æ·»åŠ æ‰¹é‡åˆ é™¤ç›¸å…³å‡½æ•°
        function toggleInspiration(checkbox) {
            const batchDeleteBtn = document.getElementById('batchDeleteBtn');
            const batchMergeBtn = document.getElementById('batchMergeBtn');
            const checkedBoxes = document.querySelectorAll('.inspiration-select:checked');
            const hasChecked = checkedBoxes.length > 0;
            
            batchDeleteBtn.style.display = hasChecked ? '' : 'none';
            batchMergeBtn.style.display = checkedBoxes.length > 1 ? '' : 'none';
        }

        function batchDeleteInspirations() {
            const checkedBoxes = document.querySelectorAll('.inspiration-select:checked');
            if (checkedBoxes.length === 0) return;

            const itemsToDelete = Array.from(checkedBoxes).map(checkbox => 
                checkbox.closest('.inspiration-item').dataset.id
            );

            appData.inspirations = appData.inspirations.filter(insp => 
                !itemsToDelete.includes(insp.id)
            );

            // é‡æ–°ç¼–å·
            appData.inspirations.forEach((insp, index) => {
                insp.number = index + 1;
            });

            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode();
        }

        // 1. ä¿®æ”¹å‡ºç”Ÿæ—¥æœŸè¡¨å•éƒ¨åˆ†çš„HTML
        function updateBirthDateDisplay() {
            const birthDateForm = document.getElementById('birthDateForm');
            if (appData.birthDate) {
                // å·²è®¾ç½®å‡ºç”Ÿæ—¥æœŸæ—¶æ˜¾ç¤ºå¹´é¾„å’Œä¿®æ”¹æŒ‰é’®
                birthDateForm.innerHTML = `
                    <div class="current-age mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="text-muted small">å½“å‰å¹´é¾„</div>
                                <div class="fs-5 fw-bold">${calculateAge(appData.birthDate)}å²</div>
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm" onclick="showBirthDateInput()">
                                ä¿®æ”¹
                            </button>
                        </div>
                    </div>
                `;
            } else {
                // æœªè®¾ç½®æ—¶æ˜¾ç¤ºè¾“å…¥è¡¨å•
                birthDateForm.innerHTML = `
                    <div class="mb-3">
                        <label class="form-label">å‡ºç”Ÿæ—¥æœŸ (YYYYMMDD):</label>
                        <input type="text" class="form-control" id="birthDate" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">è®¾ç½®å‡ºç”Ÿæ—¥æœŸ</button>
                `;
            }
        }

        // 2. æ·»åŠ æ˜¾ç¤ºå‡ºç”Ÿæ—¥æœŸè¾“å…¥æ¡†çš„å‡½æ•°
        function showBirthDateInput() {
            const birthDateForm = document.getElementById('birthDateForm');
            birthDateForm.innerHTML = `
                <div class="mb-3">
                    <label class="form-label">å‡ºç”Ÿæ—¥æœŸ (YYYYMMDD):</label>
                    <input type="text" class="form-control" id="birthDate" value="${appData.birthDate || ''}" required>
                </div>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-primary flex-grow-1" onclick="saveBirthDate()">ç¡®è®¤</button>
                    <button type="button" class="btn btn-secondary" onclick="updateBirthDateDisplay()">å–æ¶ˆ</button>
                </div>
            `;
        }

        // 3. æ·»åŠ è®¡ç®—å¹´é¾„çš„å‡½æ•°
        function calculateAge(birthDateStr) {
            const birthDate = parseDateString(birthDateStr);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            
            return age;
        }

        // 4. ä¿®æ”¹å­˜å–æ¬¾æ“ä½œéƒ¨åˆ†çš„HTML
        const depositWithdrawForm = `
            <div class="card mt-2">
                <div class="card-header py-2">è®°å½•å­˜å–æ¬¾</div>
                <div class="card-body p-2">
                    <form id="moneyForm">
                        <div class="mb-2">
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="operationType" id="depositType" value="deposit" checked>
                                <label class="btn btn-outline-success" for="depositType">å­˜å…¥</label>
                                
                                <input type="radio" class="btn-check" name="operationType" id="withdrawType" value="withdraw">
                                <label class="btn btn-outline-warning" for="withdrawType">å–å‡º</label>
                            </div>
                        </div>
                        <div class="mb-2">
                            <label class="form-label mb-1">é‡‘é¢:</label>
                            <input type="text" class="form-control form-control-sm" id="amount" required>
                        </div>
                        <div class="mb-2">
                            <label class="form-label mb-1">å¤‡æ³¨:</label>
                            <input type="text" class="form-control form-control-sm" id="note" placeholder="å¯é€‰">
                        </div>
                        <button type="submit" class="btn btn-primary btn-sm w-100">ç¡®è®¤</button>
                    </form>
                </div>
            </div>
        `;

        // 5. ä¿®æ”¹äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', () => {
            // ... å…¶ä»–åˆå§‹åŒ–ä»£ç  ...
            
            // æ›´æ–°å‡ºç”Ÿæ—¥æœŸæ˜¾ç¤º
            updateBirthDateDisplay();
            
            // æ›¿æ¢å­˜å–æ¬¾è¡¨å•
            const depositWithdrawContainer = document.querySelector('.card.mt-2');
            if (depositWithdrawContainer) {
                depositWithdrawContainer.outerHTML = depositWithdrawForm;
            }
            
            // æ·»åŠ å­˜å–æ¬¾è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('moneyForm').addEventListener('submit', (e) => {
                e.preventDefault();
                try {
                    const operationType = document.querySelector('input[name="operationType"]:checked').value;
                    const amountStr = document.getElementById('amount').value;
                    const note = document.getElementById('note').value;
                    const amount = parseAmount(amountStr);
                    
                    if (operationType === 'withdraw' && amount > appData.totalSaved) {
                        throw new Error('å–æ¬¾é‡‘é¢ä¸èƒ½å¤§äºæ€»å­˜æ¬¾');
                    }
                    
                    const currentMoney = SafeMoney.fromYuan(appData.totalSaved);
                    const operationMoney = SafeMoney.fromYuan(amount);
                    
                    if (operationType === 'deposit') {
                        appData.totalSaved = currentMoney.add(operationMoney).toYuan();
                    } else {
                        appData.totalSaved = currentMoney.subtract(operationMoney).toYuan();
                    }
                    
                    addHistory(operationType, amount, note);
                    
                    document.getElementById('amount').value = '';
                    document.getElementById('note').value = '';
                    
                    renderViewMode();
                } catch (error) {
                    alert(error.message);
                }
            });
        });


        // æ–°å¢ä¿å­˜å‡ºç”Ÿæ—¥æœŸçš„å‡½æ•°
        function saveBirthDate() {
            const birthDateStr = document.getElementById('birthDate').value;
            
            if (!/^\d{8}$/.test(birthDateStr)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ—¥æœŸæ ¼å¼ï¼ˆä¾‹å¦‚ï¼š20000101ï¼‰');
                return;
            }
            
            try {
                const birthDate = parseDateString(birthDateStr);
                if (birthDate > new Date()) {
                    alert('å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šäºå½“å‰æ—¥æœŸ');
                    return;
                }
                
                // ç›´æ¥ä¿å­˜ï¼Œä¸å†å¼¹å‡ºç¡®è®¤çª—å£
                appData.birthDate = birthDateStr;
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                updateBirthDateDisplay();
                //renderViewMode();
            } catch (error) {
                alert('æ—¥æœŸæ ¼å¼æ— æ•ˆï¼Œè¯·é‡è¯•');
            }
        }


        // æ·»åŠ æ›´æ–°æ—¶é—´çš„å‡½æ•°
        function updateDateTime() {
            const now = new Date();
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            const dateStr = now.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
            
            // æ ¼å¼åŒ–æ—¶é—´ï¼ˆç²¾ç¡®åˆ°åˆ†é’Ÿï¼‰
            const timeStr = now.toLocaleTimeString('zh-CN', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('currentDate').textContent = dateStr;
            document.getElementById('currentTime').textContent = timeStr;
        }

        // é¡µé¢åŠ è½½æ—¶ç«‹å³æ›´æ–°ä¸€æ¬¡
        updateDateTime();

        // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡æ—¶é—´
        setInterval(updateDateTime, 60000);

        // åˆå¹¶ showAgeSettingsModal å’Œ showAddInspirationModal ç­‰ç±»ä¼¼çš„æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°
        // å¯ä»¥åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ showModal å‡½æ•°ï¼Œä¼ å…¥ä¸åŒçš„é…ç½®

        function showModal(config) {
            const { id, title, content, onSave } = config;
            // é€šç”¨çš„æ¨¡æ€æ¡†æ˜¾ç¤ºé€»è¾‘
        }

        // ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘
        function handleError(error) {
            alert(error.message || 'æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•');
        }

        // åœ¨å…¶ä»–åœ°æ–¹ç»Ÿä¸€ä½¿ç”¨
        try {
            // ä¸šåŠ¡é€»è¾‘
        } catch (error) {
            handleError(error);
        }

        // å°†é¢‘ç¹çš„ DOM æ“ä½œåˆå¹¶
        function renderViewModeElements(updates) {
            Object.entries(updates).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        // ä½¿ç”¨äº‹ä»¶å§”æ‰˜æ›¿ä»£å¤šä¸ªç‹¬ç«‹çš„äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('click', (e) => {
            const target = e.target;
            if (target.matches('.btn-edit')) {
                editItem(target.dataset.id);
            } else if (target.matches('.btn-delete')) {
                deleteItem(target.dataset.id);
            }
        });

        // æ·»åŠ æ˜¾ç¤ºåˆå¹¶æ¨¡æ€æ¡†çš„å‡½æ•°
        function showMergeModal() {
            const checkedBoxes = document.querySelectorAll('.inspiration-select:checked');
            const selectedInspirations = Array.from(checkedBoxes).map(checkbox => {
                const itemId = checkbox.closest('.inspiration-item').dataset.id;
                return appData.inspirations.find(insp => insp.id === itemId);
            });

            const mergedContent = selectedInspirations.map(insp => insp.content).join('\n\n');
            const allTags = new Set();
            selectedInspirations.forEach(insp => {
                if (insp.tags) {
                    insp.tags.forEach(tag => allTags.add(tag));
                }
            });

            const modalHtml = `
                <div class="modal fade" id="mergeModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">åˆå¹¶çµæ„Ÿ</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="mergeForm">
                                    <div class="mb-3">
                                        <label class="form-label">åˆå¹¶åçš„å†…å®¹</label>
                                        <textarea class="form-control" id="mergedContent" rows="10">${mergedContent}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">æ ‡ç­¾</label>
                                        <div class="tag-selection">
                                            ${appData.inspirationTags.map(tag => `
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="checkbox" 
                                                           id="merge-tag-${tag}" value="${tag}"
                                                           ${allTags.has(tag) ? 'checked' : ''}>
                                                    <label class="form-check-label" for="merge-tag-${tag}">${tag}</label>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="mergeInspirations()">åˆå¹¶</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            const existingModal = document.getElementById('mergeModal');
            if (existingModal) {
                existingModal.remove();
            }
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            const modal = new bootstrap.Modal(document.getElementById('mergeModal'));
            modal.show();
        }

        // æ·»åŠ åˆå¹¶çµæ„Ÿçš„å‡½æ•°
        function mergeInspirations() {
            const mergedContent = document.getElementById('mergedContent').value.trim();
            if (!mergedContent) {
                alert('è¯·è¾“å…¥åˆå¹¶åçš„å†…å®¹');
                return;
            }

            // è·å–é€‰ä¸­çš„æ ‡ç­¾
            const selectedTags = appData.inspirationTags
                .filter(tag => document.getElementById(`merge-tag-${tag}`).checked);

            // è·å–è¦åˆå¹¶çš„çµæ„Ÿ
            const checkedBoxes = document.querySelectorAll('.inspiration-select:checked');
            const itemsToMerge = Array.from(checkedBoxes).map(checkbox => 
                checkbox.closest('.inspiration-item').dataset.id
            );

            // åˆ›å»ºæ–°çš„åˆå¹¶åçš„çµæ„Ÿ
            const maxNumber = appData.inspirations.reduce((max, insp) => 
                Math.max(max, insp.number || 0), 0);

            const newInspiration = {
                id: Date.now().toString(),
                number: maxNumber + 1,
                content: mergedContent,
                tags: selectedTags,
                createTime: Date.now(),
                updateTime: Date.now()
            };

            // åˆ é™¤åŸæ¥çš„çµæ„Ÿ
            appData.inspirations = appData.inspirations.filter(insp => 
                !itemsToMerge.includes(insp.id)
            );

            // æ·»åŠ åˆå¹¶åçš„æ–°çµæ„Ÿ
            appData.inspirations.push(newInspiration);

            // é‡æ–°ç¼–å·
            appData.inspirations.forEach((insp, index) => {
                insp.number = index + 1;
            });

            // ä¿å­˜æ•°æ®å¹¶æ›´æ–°ç•Œé¢
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            
            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('mergeModal'));
            modal.hide();

            renderViewMode();
            showToast('çµæ„Ÿåˆå¹¶æˆåŠŸ');
        }

        // æ·»åŠ createModalå‡½æ•°
        function createModal({ id, title, content, onSave }) {
            return `
                <div class="modal fade" id="${id}" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">${title}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                ${content}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="${onSave}">ä¿å­˜</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // åˆå¹¶ showAgeSettingsModal å’Œ showAddInspirationModal ç­‰ç±»ä¼¼çš„æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°
        // å¯ä»¥åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ showModal å‡½æ•°ï¼Œä¼ å…¥ä¸åŒçš„é…ç½®

        // å°†æ‰¹é‡å¯¼å…¥å‡½æ•°æ·»åŠ åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.saveBulkInspirations = saveBulkInspirations;
        window.showBulkInputModal = showBulkInputModal;

        // æ·»åŠ ä¹ æƒ¯æ‰“å¡è§†å›¾çš„æ˜¾ç¤ºé€»è¾‘
        function showHabitView() {
            const container = document.querySelector('.goal-container');
            container.innerHTML = `
                <!-- æ·»åŠ ä¹ æƒ¯è¡¨å• -->
                <div class="card mb-3">
                    <div class="card-body p-3">
                        <form id="habitForm" onsubmit="addHabit(event)" class="row g-2 align-items-end">
                            <div class="col">
                                <label class="form-label">ä¹ æƒ¯åç§°</label>
                                <input type="text" class="form-control" id="habitName" required 
                                       placeholder="è¾“å…¥ä¹ æƒ¯åç§°">
                            </div>
                            <div class="col-auto">
                                <label class="form-label">ç›®æ ‡æ¬¡æ•°</label>
                                <input type="number" class="form-control" id="habitTarget" 
                                       min="1" required style="width: 100px;" placeholder="è¾“å…¥æ¬¡æ•°">
                            </div>
                            <div class="col-auto">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-plus"></i> æ·»åŠ ä¹ æƒ¯
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- ä¹ æƒ¯åˆ—è¡¨ -->
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
            `;
            
            if (!appData.habits) {
                appData.habits = [];
            }
            
            if (appData.habits.length === 0) {
                container.innerHTML += '<div class="col-12"><div class="alert alert-info">è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•ä¹ æƒ¯</div></div>';
            } else {
                appData.habits.forEach((habit, index) => {
                    const progress = (habit.count || 0) / habit.target * 100;
                    const progressClass = progress >= 100 ? 'bg-success' : 
                                        progress >= 70 ? 'bg-info' :
                                        progress >= 40 ? 'bg-warning' : 'bg-primary';
                    
                    container.innerHTML += `
                        <div class="col">
                            <div class="card h-100" data-habit-index="${index}">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h5 class="card-title mb-0">${habit.name}</h5>
                                        <button class="btn btn-outline-danger btn-sm" onclick="deleteHabit(${index})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                    <div class="progress mb-2" style="height: 8px;">
                                        <div class="progress-bar ${progressClass}" role="progressbar" 
                                             style="width: ${progress}%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="text-muted small">è¿›åº¦: ${habit.count || 0}/${habit.target}</div>
                                        <button class="btn btn-outline-success btn-sm" 
                                                onclick="incrementHabit(${index})"
                                                ${progress >= 100 ? 'disabled' : ''}>
                                            <i class="fas fa-plus"></i> æ‰“å¡
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML += '</div>';
        }

        // æ·»åŠ ç›¸å…³çš„JavaScriptå‡½æ•°
        function addHabit(event) {
            event.preventDefault();
            const name = document.getElementById('habitName').value.trim();
            const target = parseInt(document.getElementById('habitTarget').value);
            
            if (!name) {
                alert('è¯·è¾“å…¥ä¹ æƒ¯åç§°');
                return;
            }
            
            if (!target || target < 1) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç›®æ ‡æ¬¡æ•°');
                return;
            }
            
            if (!appData.habits) {
                appData.habits = [];
            }
            
            appData.habits.push({
                name,
                target,
                count: 0,
                createTime: Date.now()
            });
            
            saveData();  // è¿™é‡Œä¿ç•™ saveDataï¼Œå› ä¸ºéœ€è¦æ˜¾ç¤ºæ–°æ·»åŠ çš„ä¹ æƒ¯
            document.getElementById('habitForm').reset();
            showToast('ä¹ æƒ¯æ·»åŠ æˆåŠŸ');
        }

        function incrementHabit(index) {
            if (appData.habits[index].count < appData.habits[index].target) {
                appData.habits[index].count = (appData.habits[index].count || 0) + 1;
                // åªä¿å­˜æ•°æ®ï¼Œä¸åˆ·æ–°ç•Œé¢
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                
                // åªæ›´æ–°å½“å‰ä¹ æƒ¯çš„è¿›åº¦
                const habit = appData.habits[index];
                const progress = (habit.count / habit.target) * 100;
                const progressClass = progress >= 100 ? 'bg-success' : 
                                    progress >= 70 ? 'bg-info' :
                                    progress >= 40 ? 'bg-warning' : 'bg-primary';
                
                // è·å–å½“å‰ä¹ æƒ¯çš„å¡ç‰‡ï¼ˆä¿®æ”¹ä¸ºä½¿ç”¨data-habit-indexå±æ€§æ¥å®šä½ï¼‰
                const currentCard = document.querySelector(`.goal-container [data-habit-index="${index}"]`);
                if (currentCard) {
                    // æ›´æ–°è¿›åº¦æ¡
                    const progressBar = currentCard.querySelector('.progress-bar');
                    if (progressBar) {
                        progressBar.className = `progress-bar ${progressClass}`;
                        progressBar.style.width = `${progress}%`;
                    }
                    
                    // æ›´æ–°è¿›åº¦æ–‡æœ¬
                    const progressText = currentCard.querySelector('.text-muted.small');
                    if (progressText) {
                        progressText.textContent = `è¿›åº¦: ${habit.count}/${habit.target}`;
                    }
                    
                    // å¦‚æœè¾¾åˆ°ç›®æ ‡ï¼Œç¦ç”¨æ‰“å¡æŒ‰é’®
                    const incrementBtn = currentCard.querySelector('.btn-outline-success');
                    if (incrementBtn && progress >= 100) {
                        incrementBtn.disabled = true;
                    }
                }
            }
        }

        function deleteHabit(index) {
            appData.habits.splice(index, 1);
            saveData();
            showToast('ä¹ æƒ¯å·²åˆ é™¤');
        }

        // åœ¨åˆå§‹åŒ–æ—¶æ·»åŠ äº‹ä»¶ç›‘å¬
        document.getElementById('habitForm').addEventListener('submit', addHabit);
        document.getElementById('habitMode').addEventListener('change', () => {
            if (document.getElementById('habitMode').checked) {
                showHabitView();
            }
        });

        // ä¿®æ”¹ saveData å‡½æ•°
        function saveData() {
            // ä¿å­˜å‰è·å–å½“å‰è§†å›¾çŠ¶æ€
            const currentView = document.getElementById('timeTrackingMode').checked ? 'timeTracking' :
                              document.getElementById('habitMode').checked ? 'habit' :
                              document.getElementById('inspirationMode').checked ? 'inspiration' :
                              document.getElementById('todoMode').checked ? 'todo' :
                              document.getElementById('archiveMode').checked ? 'archive' :
                              document.getElementById('historyMode').checked ? 'history' :
                              document.getElementById('ageMode').checked ? 'age' : 'savings';

            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            //renderViewMode(currentView); // ä½¿ç”¨å½“å‰è§†å›¾æ›´æ–°UI
            if (currentView !== 'age') {
                renderViewMode(currentView);
            }
        }

        // ä¿®æ”¹æ·»åŠ æ—¶é—´çš„å‡½æ•°
        function addTime(eventCard) {
            const timeInput = eventCard.querySelector('.time-input');
            const timeTotal = eventCard.querySelector('.time-total');
            const eventId = parseInt(eventCard.dataset.eventId);
            
            const minutes = parseTimeInput(timeInput.value);
            if (minutes === 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¶é—´æ ¼å¼ï¼ˆä¾‹ï¼š1h30mï¼‰');
                return;
            }

            // æ›´æ–°æ•°æ®
            const event = appData.timeEvents.find(e => e.id === eventId);
            if (event) {
                event.totalMinutes = (event.totalMinutes || 0) + minutes;
                timeTotal.textContent = formatTime(event.totalMinutes);
                timeInput.value = '';
                
                // ä¿å­˜æ•°æ®
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            }
        }

        // ä¿®æ”¹åˆ é™¤äº‹ä»¶çš„å‡½æ•°
        function deleteEvent(eventCard) {
            const eventId = parseInt(eventCard.dataset.eventId);
            // ä»æ•°æ®ä¸­åˆ é™¤
            appData.timeEvents = appData.timeEvents.filter(e => e.id !== eventId);
            // ä»ç•Œé¢ä¸­åˆ é™¤
            eventCard.remove();
            // ä¿å­˜æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // ä¿®æ”¹æ·»åŠ æ–°äº‹ä»¶çš„å‡½æ•°
        function addNewEvent() {
            const eventName = prompt('è¯·è¾“å…¥äº‹ä»¶åç§°ï¼š');
            if (!eventName) return;

            // åˆ›å»ºæ–°äº‹ä»¶å¯¹è±¡
            const newEvent = {
                name: eventName,
                totalMinutes: 0,
                id: Date.now()
            };

            // æ·»åŠ åˆ°æ•°æ®ä¸­
            appData.timeEvents.push(newEvent);
            
            // æ›´æ–°ç•Œé¢
            renderTimeEvent(newEvent);
            
            // ä¿å­˜æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // æ·»åŠ æ¸²æŸ“å•ä¸ªäº‹ä»¶çš„å‡½æ•°
        function renderTimeEvent(event) {
            const eventsContainer = document.getElementById('events-container');
            const eventCard = document.createElement('div');
            eventCard.className = 'event-card';
            eventCard.dataset.eventId = event.id;
            eventCard.innerHTML = `
                <div class="event-header">
                    <span class="event-name">${event.name}</span>
                    <div>
                        <input type="text" class="time-input" placeholder="ä¾‹ï¼š1h30m">
                        <button class="btn btn-success btn-sm" onclick="addTime(this.parentElement.parentElement.parentElement)">
                            <i class="fas fa-plus"></i> æ·»åŠ 
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteEvent(this.parentElement.parentElement.parentElement)">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </button>
                    </div>
                </div>
                <div class="time-total">${formatTime(event.totalMinutes || 0)}</div>
            `;
            eventsContainer.appendChild(eventCard);
        }

        // æ·»åŠ æ¸²æŸ“æ‰€æœ‰æ—¶é—´ç»Ÿè®¡äº‹ä»¶çš„å‡½æ•°
        function renderAllTimeEvents() {
            const eventsContainer = document.getElementById('events-container');
            if (!eventsContainer) return;
            
            eventsContainer.innerHTML = ''; // æ¸…ç©ºå®¹å™¨
            appData.timeEvents.forEach(event => {
                renderTimeEvent(event);
            });
        }

        // ä¿®æ”¹æ˜¾ç¤ºæ—¶é—´ç»Ÿè®¡è§†å›¾çš„å‡½æ•°
        function showTimeTrackingView() {
            const container = document.getElementById('goalsContainer');
            if (!container) return;
            
            // æ¸…ç©ºå®¹å™¨å¹¶è®¾ç½®åŸºæœ¬æ ·å¼
            container.style.display = 'block';
            container.className = '';
            
            // ä½¿ç”¨ç»Ÿä¸€çš„å¸ƒå±€ç»“æ„
            container.innerHTML = `
                <div class="time-tracking-container">
                    <h3 class="mb-3">æ—¶é—´ç»Ÿè®¡</h3>
                    <button class="btn btn-primary add-event-btn" onclick="addNewEvent()">
                        <i class="fas fa-plus"></i> æ·»åŠ æ–°äº‹ä»¶
                    </button>
                    <div id="events-container" class="mt-3">
                        <!-- äº‹ä»¶å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            `;
            
            // ç¡®ä¿timeEventsæ•°ç»„å­˜åœ¨
            if (!Array.isArray(appData.timeEvents)) {
                appData.timeEvents = [];
            }
            
            // æ¸²æŸ“æ‰€æœ‰äº‹ä»¶
            renderAllTimeEvents();
        }

        // åœ¨åˆå§‹åŒ–æ—¶æ·»åŠ äº‹ä»¶ç›‘å¬
        document.getElementById('timeTrackingMode').addEventListener('change', () => {
            if (document.getElementById('timeTrackingMode').checked) {
                showTimeTrackingView();
            }
        });

        // æ·»åŠ äº‹ä»¶ç›‘å¬
        document.addEventListener('DOMContentLoaded', function() {
            const timeTrackingMode = document.getElementById('timeTrackingMode');
            if (timeTrackingMode) {
                timeTrackingMode.addEventListener('change', function() {
                    if (this.checked) {
                        renderViewMode('timeTracking');
                    }
                });
            }
        });

        function parseTimeInput(timeStr) {
            let totalMinutes = 0;
            const hourMatch = timeStr.match(/(\d+)h/);
            const minuteMatch = timeStr.match(/(\d+)m/);
            
            if (hourMatch) {
                totalMinutes += parseInt(hourMatch[1]) * 60;
            }
            if (minuteMatch) {
                totalMinutes += parseInt(minuteMatch[1]);
            }
            
            return totalMinutes;
        }

        function formatTime(totalMinutes) {
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            if (hours > 0) {
                return `æ€»æ—¶é—´ï¼š${hours}å°æ—¶${minutes > 0 ? ` ${minutes}åˆ†é’Ÿ` : ''}`;
            }
            return `æ€»æ—¶é—´ï¼š${minutes}åˆ†é’Ÿ`;
        }

        // æ˜¾ç¤ºä¸ªäººæ•°æ®ç•Œé¢
        function displayPersonalData(container) {
            // ç¡®ä¿appDataä¸­æœ‰personalDataå¯¹è±¡
            if (!appData.personalData) {
                appData.personalData = {
                    categories: []
                };
            }

            container.innerHTML = `
                <div class="personal-data-container">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">ä¸ªäººæ•°æ®ç®¡ç†</h5>
                        <button class="btn btn-primary btn-sm" onclick="addDataCategory()">
                            <i class="fas fa-plus"></i> æ·»åŠ æ•°æ®åˆ†ç±»
                        </button>
                    </div>
                    <div class="categories-container">
                        ${appData.personalData.categories.map((category, index) => `
                            <div class="card mb-3 data-category" data-category-id="${category.id}">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">${category.name}</h6>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline-primary" onclick="addDataItem(${category.id})">
                                            <i class="fas fa-plus"></i> æ·»åŠ æ•°æ®
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCategory(${category.id})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    ${category.items ? category.items.map((item, itemIndex) => `
                                        <div class="data-item mb-2 d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="data-content">${item.content}</span>
                                                ${item.value ? `<span class="badge bg-primary ms-2">${item.value}</span>` : ''}
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-sm btn-outline-secondary" onclick="editDataItem(${category.id}, ${itemIndex})">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="deleteDataItem(${category.id}, ${itemIndex})">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    `).join('') : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // æ·»åŠ æ•°æ®åˆ†ç±»
        function addDataCategory() {
            const categoryName = prompt('è¯·è¾“å…¥æ•°æ®åˆ†ç±»åç§°ï¼š');
            if (categoryName) {
                if (!appData.personalData.categories) {
                    appData.personalData.categories = [];
                }
                appData.personalData.categories.push({
                    id: Date.now(),
                    name: categoryName,
                    items: []
                });
                renderViewMode('personalData');
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            }
        }

        // åˆ é™¤æ•°æ®åˆ†ç±»
        function deleteCategory(categoryId) {
            appData.personalData.categories = appData.personalData.categories.filter(c => c.id !== categoryId);
            renderViewMode('personalData');
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
        }

        // æ·»åŠ æ•°æ®é¡¹
        function addDataItem(categoryId) {
            const input = prompt('è¯·è¾“å…¥æ•°æ®é¡¹å’Œå€¼ï¼ˆæ ¼å¼ï¼šæ•°æ®é¡¹å†…å®¹ æ•°æ®å€¼ï¼‰ï¼š');
            if (!input) return;
            
            // ç”¨ç¬¬ä¸€ä¸ªç©ºæ ¼åˆ†éš”æ•°æ®é¡¹å’Œå€¼
            const [itemName, ...valueParts] = input.split(' ');
            const itemValue = valueParts.join(' '); // é‡æ–°ç»„åˆå€¼éƒ¨åˆ†ï¼Œä»¥é˜²å€¼ä¸­åŒ…å«ç©ºæ ¼
            
            if (!itemName) return;

            // æ‰¾åˆ°å¯¹åº”çš„åˆ†ç±»
            const category = appData.personalData.categories.find(c => c.id === categoryId);
            if (!category) return;

            // ç¡®ä¿itemsæ•°ç»„å­˜åœ¨
            if (!category.items) {
                category.items = [];
            }

            // æ·»åŠ æ–°çš„æ•°æ®é¡¹
            category.items.push({
                name: itemName,
                value: itemValue || ''
            });

            // æ›´æ–°ç•Œé¢å’Œä¿å­˜æ•°æ®
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode('personalData');
        }

        // ç¼–è¾‘æ•°æ®é¡¹
        function editDataItem(categoryId, itemIndex) {
            const category = appData.personalData.categories.find(c => c.id === categoryId);
            if (category && category.items[itemIndex]) {
                const item = category.items[itemIndex];
                const input = prompt('è¯·è¾“å…¥æ•°æ®é¡¹å’Œå€¼ï¼ˆæ ¼å¼ï¼šæ•°æ®é¡¹å†…å®¹ æ•°æ®å€¼ï¼‰ï¼š', `${item.name} ${item.value}`);
                if (!input) return;
                
                // ç”¨ç¬¬ä¸€ä¸ªç©ºæ ¼åˆ†éš”æ•°æ®é¡¹å’Œå€¼
                const [newName, ...valueParts] = input.split(' ');
                const newValue = valueParts.join(' '); // é‡æ–°ç»„åˆå€¼éƒ¨åˆ†ï¼Œä»¥é˜²å€¼ä¸­åŒ…å«ç©ºæ ¼
                
                if (newName) {
                    item.name = newName;
                    item.value = newValue || '';
                    localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                    renderViewMode('personalData');
                }
            }
        }

        // åˆ é™¤æ•°æ®é¡¹
        function deleteDataItem(categoryId, itemIndex) {
            const category = appData.personalData.categories.find(c => c.id === categoryId);
            if (category) {
                category.items.splice(itemIndex, 1);
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode('personalData');
            }
        }

        // æ˜¾ç¤ºä¸ªäººæ•°æ®ç•Œé¢
        function displayPersonalData(container) {
            // ç¡®ä¿appDataä¸­æœ‰personalDataå¯¹è±¡
            if (!appData.personalData) {
                appData.personalData = {
                    categories: []
                };
            }

            container.innerHTML = `
                <div class="personal-data-container">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">ä¸ªäººæ•°æ®ç®¡ç†</h5>
                        <button class="btn btn-primary btn-sm" onclick="addDataCategory()">
                            <i class="fas fa-plus"></i> æ·»åŠ æ•°æ®åˆ†ç±»
                        </button>
                    </div>
                    <div class="categories-container">
                        ${appData.personalData.categories.map((category, index) => `
                            <div class="card mb-3 data-category" data-category-id="${category.id}">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">${category.name}</h6>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline-primary" onclick="addDataItem(${category.id})">
                                            <i class="fas fa-plus"></i> 
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCategory(${category.id})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    ${category.items && category.items.length > 0 ? category.items.map((item, itemIndex) => `
                                        <div class="data-item d-flex justify-content-between align-items-center mb-2">
                                            <div class="d-flex" style="width: 70%;">
                                                <span class="data-name" style="width: 120px; min-width: 120px;">${item.name}</span>
                                                <span class="data-value" style="color: #0d6efd;">${item.value || ''}</span>
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-sm btn-outline-secondary" onclick="editDataItem(${category.id}, ${itemIndex})">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="deleteDataItem(${category.id}, ${itemIndex})">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    `).join('') : '<div class="text-muted">æš‚æ— æ•°æ®é¡¹</div>'}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // æ·»åŠ æ•°æ®åˆ†ç±»
        window.addDataCategory = function() {
            const categoryName = prompt('è¯·è¾“å…¥åˆ†ç±»åç§°ï¼š');
            if (categoryName) {
                appData.personalData.categories.push({
                    id: Date.now(),
                    name: categoryName,
                    items: []
                });
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode('personalData');
            }
        };

        // åˆ é™¤æ•°æ®åˆ†ç±»
        window.deleteCategory = function(categoryId) {
            appData.personalData.categories = appData.personalData.categories.filter(category => category.id !== categoryId);
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
            renderViewMode('personalData');
        };

        // ç¼–è¾‘æ•°æ®é¡¹
        window.editDataItem = function(categoryId, itemIndex) {
            const category = appData.personalData.categories.find(c => c.id === categoryId);
            if (category && category.items[itemIndex]) {
                const newName = prompt('è¯·è¾“å…¥æ–°çš„æ•°æ®é¡¹åç§°ï¼š', category.items[itemIndex].name);
                if (newName) {
                    category.items[itemIndex].name = newName;
                    localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                    renderViewMode('personalData');
                }
            }
        };

        // åˆ é™¤æ•°æ®é¡¹
        window.deleteDataItem = function(categoryId, itemIndex) {
            const category = appData.personalData.categories.find(c => c.id === categoryId);
            if (category) {
                category.items.splice(itemIndex, 1);
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(appData));
                renderViewMode('personalData');
            }
        };
    </script>
</body>
</html> 